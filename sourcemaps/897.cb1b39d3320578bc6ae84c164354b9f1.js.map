{"version":3,"file":"js/897.b904809e7843a2568687.js","mappings":"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","sources":["webpack:///./src/SmartComponents/Vulnerability/VulnerabilityCard.js"],"sourcesContent":["import './VulnerabilityCard.scss';\n\nimport * as AppActions from '../../AppActions';\n\nimport {\n    Button,\n    TextContent,\n    Tooltip,\n    TooltipPosition\n} from '@patternfly/react-core/dist/esm/components';\nimport { Flex } from '@patternfly/react-core/dist/esm/layouts';\nimport React, { useEffect } from 'react';\nimport { fitContent, Table, TableBody, TableHeader, TableText, textCenter } from '@patternfly/react-table';\nimport { TemplateCard, TemplateCardBody, TemplateCardHeader } from '../../PresentationalComponents/Template/TemplateCard';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { CompoundCard } from '../../PresentationalComponents/Template/CompoundCard';\nimport { ExpandableCardTemplate } from '../../PresentationalComponents/Template/ExpandableCardTemplate';\nimport FailState from '../../PresentationalComponents/FailState/FailState';\nimport InfoIcon from '../../Icons/InfoIcon';\nimport Loading from '../../PresentationalComponents/Loading/Loading';\nimport { PieChart } from '../../ChartTemplates/PieChart/PieChartTemplate';\nimport { UI_BASE } from '../../AppConstants';\nimport global_disabled_color_100 from '@patternfly/react-tokens/dist/esm/global_disabled_color_100';\nimport messages from '../../Messages';\nimport { useIntl } from 'react-intl';\nimport { useChromePush } from '../../Utilities/hooks/useChromePush';\n\nconst VulnerabilityCard = () => {\n    const intl = useIntl();\n    const pieChartPadding = { bottom: 0, left: 0, right: 0, top: 0 };\n    let chartData = [];\n    let rows = [];\n    let legendLink = [];\n    const dispatch = useDispatch();\n    const vulnerabilities = useSelector(({ DashboardStore }) => DashboardStore.vulnerabilities);\n    const vulnerabilitiesFetchStatus = useSelector(({ DashboardStore }) => DashboardStore.vulnerabilitiesFetchStatus);\n    const selectedTags = useSelector(({ DashboardStore }) => DashboardStore.selectedTags);\n    const workloads = useSelector(({ DashboardStore }) => DashboardStore.workloads);\n    const SID = useSelector(({ DashboardStore }) => DashboardStore.SID);\n    const strong = str => <strong>{str}</strong>;\n\n    const navigateTo = useChromePush();\n\n    const iconTooltip = text => <Tooltip\n        key={text}\n        position={TooltipPosition.right}\n        content={<div>{text}</div>}>\n        <span aria-label='Action' className='insd-c-info-icon pf-u-ml-sm'>\n            <InfoIcon />\n        </span>\n    </Tooltip>;\n\n    const columns = [\n        {\n            title: 'CVSS score'\n        },\n        {\n            title: 'CVE totals',\n            transforms: [textCenter],\n            cellTransforms: [textCenter]\n        },\n        {\n            title: (\n                <span>Known exploits{iconTooltip(intl.formatMessage(messages.exploitedCveTooltip))}</span>\n            ),\n            transforms: [fitContent]\n        }];\n\n    useEffect(() => {\n        const options = {\n            ...workloads?.SAP?.isSelected && { sap_system: true },\n            ...SID?.length > 0 && { sap_sids: SID },\n            ...selectedTags?.length > 0 && { tags: selectedTags }\n        };\n        const fetchVulnerabilities = options => dispatch(AppActions.fetchVulnerabilities(options));\n\n        fetchVulnerabilities(options);\n    }, [workloads, SID, selectedTags, dispatch]);\n\n    if (vulnerabilitiesFetchStatus === 'fulfilled') {\n        let { cves_by_severity: bySeverity } = vulnerabilities;\n\n        chartData = [{\n            x: 'CVSS 8.0 - 10',\n            from: 8.0,\n            to: 10.0,\n            y: bySeverity['8to10'].count,\n            fill: '#a30000',\n            data: bySeverity['8to10']\n        },\n        {\n            x: 'CVSS 4.0 - 7.9',\n            from: 4.0,\n            to: 7.9,\n            y: bySeverity['4to7.9'].count,\n            fill: '#ec7a08',\n            data: bySeverity['4to7.9']\n        },\n        {\n            x: 'CVSS 0.0 - 3.9',\n            from: 0.0,\n            to: 3.9,\n            y: bySeverity['0to3.9'].count,\n            fill: '#f0ab00',\n            data: bySeverity['0to3.9']\n        }];\n\n        legendLink = (from, to) => `${UI_BASE}/vulnerability/cves?cvss_from=${from}&cvss_to=${to}`;\n\n        rows = chartData.map(({ data, from, to, fill }) => [{\n            title: <TableText wrapModifier='nowrap' className='insd-c-legend__dot'\n                style={{ '--insd-c-legend__dot--BackgroundColor': `${fill}` }}>\n                <a onClick={e => navigateTo(e, legendLink(from, to))} href={legendLink(from, to)}>{`${from}.0 - ${to}`}</a>\n            </TableText>\n        }, {\n            title:\n                <a\n                    onClick={e => navigateTo(e, legendLink(from, to))}\n                    href={legendLink(from, to)}\n                    className='pf-u-text-align-center'\n                >\n                    {data.count}\n                </a>,\n            props: { textCenter: true }\n        }, {\n            title:\n                <a\n                    onClick={e => navigateTo(e, legendLink(from, to) + '&known_exploit=true')}\n                    href={legendLink(from, to) + '&known_exploit=true'}\n                    className='pf-u-text-align-center'\n                >\n                    {data.known_exploits === undefined ? 'N/A' : data.known_exploits}\n                </a>,\n            props: { textCenter: true }\n        }]);\n    }\n\n    if (vulnerabilitiesFetchStatus === 'rejected') {\n        return <TemplateCard isFilled={false} className='ins-c-card__vulnerability' data-ouia-safe>\n            <TemplateCardHeader title={intl.formatMessage(messages.vulnerabilitiesTitle)} />\n            <TemplateCardBody><FailState appName='Vulnerability' /></TemplateCardBody>\n        </TemplateCard>;\n    }\n\n    return <CompoundCard className='insd-c-dashboard-card-parent insd-c-dashboard__card--compound--Vulnerabilities'\n        data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}>\n        <ExpandableCardTemplate\n            appName='Vulnerabilities'\n            className='insd-m-toggle-right-on-md insd-m-short-header'\n            data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}\n            title={intl.formatMessage(messages.vulnerabilitiesTitle)}\n            isExpanded={JSON.parse(localStorage.getItem('dashboard_expanded_vulnerability1') || 'true')}\n            isExpandedCallback={isExpanded => localStorage.setItem('dashboard_expanded_vulnerability1', isExpanded)}\n            body={vulnerabilitiesFetchStatus === 'fulfilled' ? <TemplateCardBody className='insd-c-dashboard__card--Vulnerabilities__card-body'>\n                <Flex\n                    direction={{ default: 'column' }}\n                    spaceItems={{ default: 'spaceItemsLg' }}\n                    flexWrap={{ default: 'nowrap' }}\n                >\n                    <TextContent\n                        className='insd-c-width-limiter'\n                        style={{ '--insd-c-width-limiter--MaxWidth': '54ch' }}>\n                        <p className='pf-u-font-size-sm'>\n                            {intl.formatMessage(messages.vulnerabilityMessage)}\n                        </p>\n                    </TextContent>\n                    <div className=\"insd-c-dashboard__card--Vulnerabilities--SplitMetrics\">\n                        <div className=\"insd-c-dashboard__card--Vulnerabilities--SplitMetrics__item\">\n                            <div className=\"insd-c-dashboard__card--Vulnerabilities--SplitMetrics__content\">\n                                <a className='pf-u-font-size-2xl pf-u-color-100'\n                                    onClick={e => navigateTo(e, `${UI_BASE}/vulnerability/cves?affecting=true&rule_presence=true`)}\n                                    href={`${UI_BASE}/vulnerability/cves?affecting=true&rule_presence=true`}\n                                    rel='noreferrer'>\n                                    {vulnerabilities.rules_cves_total}\n                                </a>\n                                <TextContent>\n                                    <p className='pf-u-font-size-sm'>\n                                        {intl.formatMessage(messages.cvesImpactingOneOrMoreSystems, {\n                                            cves: vulnerabilities.rules_cves_total,\n                                            strong: string => strong(string)\n                                        })}\n                                    </p>\n                                </TextContent>\n                            </div>\n                            <Button component='a' href={`${UI_BASE}/vulnerability/cves?affecting=true&rule_presence=true`}\n                                onClick={e => navigateTo(e, `${UI_BASE}/vulnerability/cves?affecting=true&rule_presence=true`)}\n                                rel='noreferrer'\n                                variant='secondary' isSmall>\n                                {intl.formatMessage(messages.vulnerabilityCardCTAText)}\n                            </Button>\n                        </div>\n                        <div className=\"insd-c-dashboard__card--Vulnerabilities--SplitMetrics__item\">\n                            <div className=\"insd-c-dashboard__card--Vulnerabilities--SplitMetrics__content\">\n                                <a className='pf-u-font-size-2xl pf-u-color-100'\n                                    onClick={e => navigateTo(e, `${UI_BASE}/vulnerability/cves?known_exploit=true&affecting=true`)}\n                                    href={`${UI_BASE}/vulnerability/cves?known_exploit=true&affecting=true`} rel='noreferrer'>\n                                    {vulnerabilities.exploited_cves_count}\n                                </a>\n                                <TextContent>\n                                    <p className='pf-u-font-size-sm'>\n                                        {intl.formatMessage(messages.knownExploitsOneOrMoreSystems, {\n                                            cves: vulnerabilities.exploited_cves_count,\n                                            strong: string => strong(string),\n                                            tooltip: () => iconTooltip(intl.formatMessage(messages.exploitedCveTooltip))\n                                        })}\n                                    </p>\n                                </TextContent>\n                            </div>\n                            <Button component='a' href={`${UI_BASE}/vulnerability/cves?known_exploit=true&affecting=true`}\n                                onClick={e => navigateTo(e, `${UI_BASE}/vulnerability/cves?known_exploit=true&affecting=true`)}\n                                rel='noreferrer'\n                                variant='secondary' isSmall>\n                                {intl.formatMessage(messages.vulnerabilityCardKnownExploitsCTAText)}\n                            </Button>\n                        </div>\n                    </div>\n                </Flex>\n            </TemplateCardBody>\n                : <Loading />\n            } />\n        <ExpandableCardTemplate\n            appName='CVESbyCVSS'\n            className='insd-m-toggle-right-on-md'\n            data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}\n            title={intl.formatMessage(messages.cveByCvssScoreTitle)}\n            isExpanded={JSON.parse(localStorage.getItem('dashboard_expanded_vulnerability2') || 'true')}\n            isExpandedCallback={isExpanded => localStorage.setItem('dashboard_expanded_vulnerability2', isExpanded)}\n            hasDivider\n            body={vulnerabilitiesFetchStatus === 'fulfilled' ? <TemplateCardBody className='ins-c-cves-by-cvss-card-body pf-u-pt-sm'>\n                <div className=\"insd-c-dashboard__card-chart-container\">\n                    <div className=\"insd-c-dashboard__card-pie-chart\">\n                        <PieChart\n                            ariaDesc={intl.formatMessage(messages.cvesImpactingSystems,\n                                { cves: vulnerabilities.cves_total })}\n                            ariaTitle='Vulnerabilities chart'\n                            constrainToVisibleArea={true}\n                            data={chartData}\n                            padding={pieChartPadding}\n                            colorScale={vulnerabilitiesFetchStatus === 'fulfilled' && vulnerabilities.cves_total === 0 ?\n                                [global_disabled_color_100.value] : ['#a30000', '#ec7a08', '#f0ab00']} />\n                    </div>\n                    <div className=\"insd-c-dashboard__card-pie-chart-legend\">\n                        <Table\n                            borders={false}\n                            aria-label='Simple Table'\n                            cells={columns}\n                            rows={rows}\n                            className='insd-m-no-styling'\n                            gridBreakPoint=''\n                        >\n                            <TableHeader />\n                            <TableBody />\n                        </Table>\n                    </div>\n                </div>\n            </TemplateCardBody>\n                : <Loading />\n            } />\n    </CompoundCard>;\n};\n\nexport default VulnerabilityCard;\n"],"names":["intl","useIntl","chartData","rows","legendLink","dispatch","useDispatch","vulnerabilities","useSelector","DashboardStore","vulnerabilitiesFetchStatus","selectedTags","workloads","SID","strong","str","navigateTo","useChromePush","iconTooltip","text","key","position","TooltipPosition","content","className","columns","title","transforms","textCenter","cellTransforms","formatMessage","messages","fitContent","useEffect","options","SAP","isSelected","sap_system","length","sap_sids","tags","AppActions","bySeverity","cves_by_severity","x","from","to","y","count","fill","data","UI_BASE","map","TableText","wrapModifier","style","onClick","e","href","props","undefined","known_exploits","isFilled","appName","isExpanded","JSON","parse","localStorage","getItem","isExpandedCallback","setItem","body","direction","default","spaceItems","flexWrap","rel","rules_cves_total","cves","string","component","variant","isSmall","exploited_cves_count","tooltip","hasDivider","ariaDesc","cves_total","ariaTitle","constrainToVisibleArea","padding","bottom","left","right","top","colorScale","global_disabled_color_100","Table","borders","cells","gridBreakPoint","TableHeader","TableBody"],"sourceRoot":""}