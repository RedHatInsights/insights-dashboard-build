(self.webpackChunkinsights_dashboard=self.webpackChunkinsights_dashboard||[]).push([[3848],{33848:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var l=a(96156),r=a(64169),n=a(32203),s=a(68774),i=a(47173),c=a(56186),o=a(28191),u=a(50693),m=a(92298),f=a(97522),d=a.n(f),b=a(38532),p=a(81404),g=a(58471),v=a(58093),y=a(82141),h=a(85875),E=a(45697),_=a.n(E),S=a(20999),C=a(43476),w=a(18623),T=a(86896),x=a(81976);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var j=function(e){var t=e.fetchVulnerabilities,a=e.vulnerabilities,l=e.vulnerabilitiesFetchStatus,r=e.workloads,E=e.SID,_=e.selectedTags;(0,f.useEffect)((function(){var e,a=N(N(N({},(null==r||null===(e=r.SAP)||void 0===e?void 0:e.isSelected)&&{sap_system:!0}),(null==E?void 0:E.length)>0&&{sap_sids:E}),(null==_?void 0:_.length)>0&&{tags:_});t(a)}),[t,r,E,_]);var C=[],x=[],O=(0,T.Z)();if("fulfilled"===l){var j=a.cves_by_severity,k=a.cves_total,I=C.map((function(e){return"".concat(S.Pu,"/vulnerability/cves?cvss_from=").concat(e.from,"&cvss_to=").concat(e.to)}));C=[{name:"CVSS 8.0 - 10",from:8,to:10,x:k,y:j["8to10"].count,fill:"#a30000"},{name:"CVSS 4.0 - 7.9",from:4,to:7.9,x:k,y:j["4to7.9"].count,fill:"#ec7a08"},{name:"CVSS 0.0 - 3.9",from:0,to:3.9,x:k,y:j["0to3.9"].count,fill:"#f0ab00"}],x=[[{title:d().createElement(b.TableText,{wrapModifier:"nowrap",className:"ins-c-table__dot",style:{"--ins-c-table__dot--BackgroundColor":"#a30000"}},d().createElement("a",{href:I[0]},"8.0 - 10"))},{title:d().createElement("a",{href:I[0],className:"pf-u-text-align-center"},j["8to10"].count),props:{textCenter:!0}}],[{title:d().createElement(b.TableText,{wrapModifier:"nowrap",className:"ins-c-table__dot",style:{"--ins-c-table__dot--BackgroundColor":"#ec7a08"}},d().createElement("a",{href:I[1],className:"pf-u-text-align-center"},"4.0 - 7.9"))},{title:d().createElement("a",{href:I[1],className:"pf-u-text-align-center"},j["4to7.9"].count),props:{textCenter:!0}}],[{title:d().createElement(b.TableText,{wrapModifier:"nowrap",className:"ins-c-table__dot",style:{"--ins-c-table__dot--BackgroundColor":"#f0ab00"}},d().createElement("a",{href:I[2]},"0.0 - 3.9"))},{title:d().createElement("a",{href:I[2]},j["0to3.9"].count),props:{textCenter:!0}}]]}var M=[{title:"CVSS score",transforms:[b.fitContent]},{title:"CVE totals",transforms:[b.fitContent]}];return"rejected"===l?d().createElement(p.wh,{isFilled:!1,className:"ins-c-card__vulnerability","data-ouia-safe":!0},d().createElement(p.ME,{title:O.formatMessage(w.Z.vulnerabilitiesTitle)}),d().createElement(p.jA,null,d().createElement(v.Z,{appName:"Vulnerability"}))):d().createElement(n.Z,{component:"div",className:"ins-c-dashboard-card-parent","data-ouia-safe":"pending"!==l},d().createElement(g.t,{appName:"Vulnerabilities",className:"ins-m-toggle-right-on-md","data-ouia-safe":"pending"!==l,title:O.formatMessage(w.Z.vulnerabilitiesTitle),body:"fulfilled"!==l?d().createElement(y.Z,null):d().createElement(p.jA,{className:"ins-c-custom-policies__card-body"},d().createElement(o.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"}},d().createElement(s.D,null,d().createElement("p",null,O.formatMessage(w.Z.vulnerabilityMessage))),d().createElement(o.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"},alignItems:{default:"alignItemsCenter"},justifyContent:{default:"justifyContentCenter"}},d().createElement(o.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},d().createElement("a",{className:"pf-u-font-size-2xl pf-u-text-align-center pf-u-color-100 pf-u-font-weight-bold",href:"".concat(S.Pu,"/vulnerability/")},O.formatMessage(w.Z.vulnerabilitiesTotalItems,{total:a.cves_total})),d().createElement(s.D,{className:"ins-c-width-limiter pf-u-text-align-center",style:{"--ins-c-width-limiter--MaxWidth":"24ch"}},d().createElement("p",null,O.formatMessage(w.Z.cvesImpactingOneOrMoreSystems,{cves:a.cves_total})))),d().createElement(i.zx,{component:"a",href:"".concat(S.Pu,"/vulnerability/"),rel:"noreferrer",target:"_blank",variant:"secondary"},O.formatMessage(w.Z.vulnerabilityCardCTAText)))))}),d().createElement(c.i,{inset:{md:"insetLg"}}),d().createElement(g.t,{appName:"CVESbyCVSS",className:"ins-m-toggle-right-on-md","data-ouia-safe":"pending"!==l,title:O.formatMessage(w.Z.cveByCvssScoreTitle),body:"fulfilled"!==l?d().createElement(y.Z,null):d().createElement(p.jA,{className:"ins-c-custom-policies__card-body"},d().createElement(u.r,{hasGutter:!0},d().createElement(o.k,{alignItems:{default:"alignItemsCenter"}},d().createElement(m.B,null,d().createElement(h.u,{ariaDesc:O.formatMessage(w.Z.cvesImpactingSystems,{cves:a.cves_total}),ariaTitle:"Vulnerabilities chart",constrainToVisibleArea:!0,data:C,labels:function(e){var t=e.datum;return"".concat(t.x,": ").concat(t.y)},padding:{bottom:0,left:0,right:0,top:0},height:100,width:100,colorScale:["#a30000","#ec7a08","#f0ab00"]})),d().createElement(m.B,{flex:{default:"flex_1s"}},d().createElement(b.Table,{borders:!1,"aria-label":"Simple Table",cells:M,rows:x,className:"ins-m-no-styling",gridBreakPoint:""},d().createElement(b.TableHeader,null),d().createElement(b.TableBody,null))))))}))};j.propTypes={fetchVulnerabilities:_().func,vulnerabilities:_().object,vulnerabilitiesFetchStatus:_().string,selectedTags:_().array,workloads:x.ib,SID:_().arrayOf(_().string)};const k=(0,C.connect)((function(e){var t=e.DashboardStore;return{vulnerabilities:t.vulnerabilities,vulnerabilitiesFetchStatus:t.vulnerabilitiesFetchStatus,selectedTags:t.selectedTags,workloads:t.workloads,SID:t.SID}}),(function(e){return{fetchVulnerabilities:function(t){return e(r.Q6(t))}}}))(j)}}]);
//# sourceMappingURL=3848.71fe2ec0e39e29d418e3.js.map