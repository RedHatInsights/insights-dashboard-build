(self.webpackChunkinsights_dashboard=self.webpackChunkinsights_dashboard||[]).push([[3848],{633848:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var r=a(896156),l=a(864169),n=a(232203),s=a(768774),c=a(247173),i=a(728191),o=a(992298),u=a(97522),m=a.n(u),f=a(238532),d=a(681404),p=a(843476),g=a(158471),b=a(858093),h=a(382141),E=a(285875),v=a(420999),y=a(518623),_=a(586896);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const N=function(){var e=(0,_.Z)(),t=[{title:"CVSS score",transforms:[f.fitContent]},{title:"CVE totals",transforms:[f.fitContent]}],a=[],r=[],S=[],N=(0,p.useDispatch)(),w=(0,p.useSelector)((function(e){return e.DashboardStore.vulnerabilities})),x=(0,p.useSelector)((function(e){return e.DashboardStore.vulnerabilitiesFetchStatus})),O=(0,p.useSelector)((function(e){return e.DashboardStore.selectedTags})),T=(0,p.useSelector)((function(e){return e.DashboardStore.workloads})),j=(0,p.useSelector)((function(e){return e.DashboardStore.SID}));if((0,u.useEffect)((function(){var e,t;t=C(C(C({},(null==T||null===(e=T.SAP)||void 0===e?void 0:e.isSelected)&&{sap_system:!0}),(null==j?void 0:j.length)>0&&{sap_sids:j}),(null==O?void 0:O.length)>0&&{tags:O}),N(l.Q6(t))}),[T,j,O,N]),"fulfilled"===x){var D=w.cves_by_severity;S=(a=[{x:"CVSS 8.0 - 10",from:8,to:10,y:D["8to10"].count,fill:"#a30000"},{x:"CVSS 4.0 - 7.9",from:4,to:7.9,y:D["4to7.9"].count,fill:"#ec7a08"},{x:"CVSS 0.0 - 3.9",from:0,to:3.9,y:D["0to3.9"].count,fill:"#f0ab00"}]).map((function(e){return"".concat(v.Pu,"/vulnerability/cves?cvss_from=").concat(e.from,"&cvss_to=").concat(e.to)})),r=[[{title:m().createElement(f.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#a30000"}},m().createElement("a",{href:S[0]},"8.0 - 10"))},{title:m().createElement("a",{href:S[0],className:"pf-u-text-align-center"},D["8to10"].count),props:{textCenter:!0}}],[{title:m().createElement(f.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#ec7a08"}},m().createElement("a",{href:S[1],className:"pf-u-text-align-center"},"4.0 - 7.9"))},{title:m().createElement("a",{href:S[1],className:"pf-u-text-align-center"},D["4to7.9"].count),props:{textCenter:!0}}],[{title:m().createElement(f.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#f0ab00"}},m().createElement("a",{href:S[2]},"0.0 - 3.9"))},{title:m().createElement("a",{href:S[2]},D["0to3.9"].count),props:{textCenter:!0}}]]}return"rejected"===x?m().createElement(d.wh,{isFilled:!1,className:"ins-c-card__vulnerability","data-ouia-safe":!0},m().createElement(d.ME,{title:e.formatMessage(y.Z.vulnerabilitiesTitle)}),m().createElement(d.jA,null,m().createElement(b.Z,{appName:"Vulnerability"}))):m().createElement(n.Z,{component:"div",className:"ins-c-dashboard-card-parent","data-ouia-safe":"pending"!==x},m().createElement(g.t,{appName:"Vulnerabilities",className:"ins-m-toggle-right-on-md ins-m-short-header","data-ouia-safe":"pending"!==x,title:e.formatMessage(y.Z.vulnerabilitiesTitle),body:"fulfilled"!==x?m().createElement(h.Z,null):m().createElement(d.jA,{className:"ins-c-custom-policies__card-body"},m().createElement(i.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"}},m().createElement(s.D,null,m().createElement("p",{className:"pf-u-font-size-sm"},e.formatMessage(y.Z.vulnerabilityMessage))),m().createElement(i.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"},alignItems:{default:"alignItemsCenter"},justifyContent:{default:"justifyContentCenter"}},m().createElement(i.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},m().createElement("a",{className:"pf-u-font-size-2xl pf-u-text-align-center pf-u-color-100",href:"".concat(v.Pu,"/vulnerability/"),rel:"noreferrer"},e.formatMessage(y.Z.vulnerabilitiesTotalItems,{total:w.rules_total||w.rules_cves_total})),m().createElement(s.D,{className:"ins-c-width-limiter pf-u-text-align-center",style:{"--ins-c-width-limiter--MaxWidth":"24ch"}},m().createElement("p",{className:"pf-u-font-size-sm"},e.formatMessage(y.Z.cvesImpactingOneOrMoreSystems,{cves:w.rules_total||w.rules_cves_total})))),m().createElement(c.zx,{component:"a",href:"".concat(v.Pu,"/vulnerability/cves?affecting=true,false&rule_presence=true"),rel:"noreferrer",variant:"secondary",isSmall:!0},e.formatMessage(y.Z.vulnerabilityCardCTAText)))))}),m().createElement(g.t,{appName:"CVESbyCVSS",className:"ins-m-toggle-right-on-md","data-ouia-safe":"pending"!==x,title:e.formatMessage(y.Z.cveByCvssScoreTitle),hasDivider:!0,body:"fulfilled"!==x?m().createElement(h.Z,null):m().createElement(d.jA,{className:"ins-c-custom-policies__card-body pf-u-pt-sm"},m().createElement(i.k,{alignItems:{default:"alignItemsCenter"}},m().createElement(o.B,null,m().createElement(E.u,{ariaDesc:e.formatMessage(y.Z.cvesImpactingSystems,{cves:w.cves_total}),ariaTitle:"Vulnerabilities chart",constrainToVisibleArea:!0,data:a,padding:{bottom:0,left:0,right:0,top:0},height:100,width:100,colorScale:["#a30000","#ec7a08","#f0ab00"]})),m().createElement(o.B,{flex:{default:"flex_1s"}},m().createElement(f.Table,{borders:!1,"aria-label":"Simple Table",cells:t,rows:r,className:"ins-m-no-styling",gridBreakPoint:""},m().createElement(f.TableHeader,null),m().createElement(f.TableBody,null)))))}))}}}]);
//# sourceMappingURL=3848.62ead0ffcde392ade6df.js.map