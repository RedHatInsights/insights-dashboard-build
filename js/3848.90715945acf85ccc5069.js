(self.webpackChunkinsights_dashboard=self.webpackChunkinsights_dashboard||[]).push([[3848],{633848:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>O});var l=a(896156),r=a(864169),n=a(232203),s=a(768774),i=a(247173),c=a(728191),o=a(992298),u=a(97522),m=a.n(u),f=a(238532),d=a(681404),p=a(158471),b=a(858093),g=a(382141),v=a(285875),h=a(45697),y=a.n(h),E=a(420999),_=a(843476),S=a(518623),C=a(586896),w=a(481976);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var N=function(e){var t=e.fetchVulnerabilities,a=e.vulnerabilities,l=e.vulnerabilitiesFetchStatus,r=e.workloads,h=e.SID,y=e.selectedTags,_=(0,C.Z)();(0,u.useEffect)((function(){var e,a=x(x(x({},(null==r||null===(e=r.SAP)||void 0===e?void 0:e.isSelected)&&{sap_system:!0}),(null==h?void 0:h.length)>0&&{sap_sids:h}),(null==y?void 0:y.length)>0&&{tags:y});t(a)}),[t,r,h,y]);var w=[{title:"CVSS score",transforms:[f.fitContent]},{title:"CVE totals",transforms:[f.fitContent]}],T=[],N=[],O=[];if("fulfilled"===l){var j=a.cves_by_severity,k=a.cves_total;O=(T=[{name:"CVSS 8.0 - 10",from:8,to:10,x:k,y:j["8to10"].count,fill:"#a30000"},{name:"CVSS 4.0 - 7.9",from:4,to:7.9,x:k,y:j["4to7.9"].count,fill:"#ec7a08"},{name:"CVSS 0.0 - 3.9",from:0,to:3.9,x:k,y:j["0to3.9"].count,fill:"#f0ab00"}]).map((function(e){return"".concat(E.Pu,"/vulnerability/cves?cvss_from=").concat(e.from,"&cvss_to=").concat(e.to)})),N=[[{title:m().createElement(f.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#a30000"}},m().createElement("a",{href:O[0]},"8.0 - 10"))},{title:m().createElement("a",{href:O[0],className:"pf-u-text-align-center"},j["8to10"].count),props:{textCenter:!0}}],[{title:m().createElement(f.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#ec7a08"}},m().createElement("a",{href:O[1],className:"pf-u-text-align-center"},"4.0 - 7.9"))},{title:m().createElement("a",{href:O[1],className:"pf-u-text-align-center"},j["4to7.9"].count),props:{textCenter:!0}}],[{title:m().createElement(f.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#f0ab00"}},m().createElement("a",{href:O[2]},"0.0 - 3.9"))},{title:m().createElement("a",{href:O[2]},j["0to3.9"].count),props:{textCenter:!0}}]]}return"rejected"===l?m().createElement(d.wh,{isFilled:!1,className:"ins-c-card__vulnerability","data-ouia-safe":!0},m().createElement(d.ME,{title:_.formatMessage(S.Z.vulnerabilitiesTitle)}),m().createElement(d.jA,null,m().createElement(b.Z,{appName:"Vulnerability"}))):m().createElement(n.Z,{component:"div",className:"ins-c-dashboard-card-parent","data-ouia-safe":"pending"!==l},m().createElement(p.t,{appName:"Vulnerabilities",className:"ins-m-toggle-right-on-md ins-m-short-header","data-ouia-safe":"pending"!==l,title:_.formatMessage(S.Z.vulnerabilitiesTitle),body:"fulfilled"!==l?m().createElement(g.Z,null):m().createElement(d.jA,{className:"ins-c-custom-policies__card-body"},m().createElement(c.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"}},m().createElement(s.D,null,m().createElement("p",{className:"pf-u-font-size-sm"},_.formatMessage(S.Z.vulnerabilityMessage))),m().createElement(c.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"},alignItems:{default:"alignItemsCenter"},justifyContent:{default:"justifyContentCenter"}},m().createElement(c.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},m().createElement("a",{className:"pf-u-font-size-2xl pf-u-text-align-center pf-u-color-100",href:"".concat(E.Pu,"/vulnerability/"),rel:"noreferrer"},_.formatMessage(S.Z.vulnerabilitiesTotalItems,{total:a.cves_total})),m().createElement(s.D,{className:"ins-c-width-limiter pf-u-text-align-center",style:{"--ins-c-width-limiter--MaxWidth":"24ch"}},m().createElement("p",{className:"pf-u-font-size-sm"},_.formatMessage(S.Z.cvesImpactingOneOrMoreSystems,{cves:a.cves_total})))),m().createElement(i.zx,{component:"a",href:"".concat(E.Pu,"/vulnerability/"),rel:"noreferrer",variant:"secondary",isSmall:!0},_.formatMessage(S.Z.vulnerabilityCardCTAText)))))}),m().createElement(p.t,{appName:"CVESbyCVSS",className:"ins-m-toggle-right-on-md","data-ouia-safe":"pending"!==l,title:_.formatMessage(S.Z.cveByCvssScoreTitle),hasDivider:!0,body:"fulfilled"!==l?m().createElement(g.Z,null):m().createElement(d.jA,{className:"ins-c-custom-policies__card-body pf-u-pt-sm"},m().createElement(c.k,{alignItems:{default:"alignItemsCenter"}},m().createElement(o.B,null,m().createElement(v.u,{ariaDesc:_.formatMessage(S.Z.cvesImpactingSystems,{cves:a.cves_total}),ariaTitle:"Vulnerabilities chart",constrainToVisibleArea:!0,data:T,labels:function(e){var t=e.datum;return"".concat(t.x,": ").concat(t.y)},padding:{bottom:0,left:0,right:0,top:0},height:100,width:100,colorScale:["#a30000","#ec7a08","#f0ab00"]})),m().createElement(o.B,{flex:{default:"flex_1s"}},m().createElement(f.Table,{borders:!1,"aria-label":"Simple Table",cells:w,rows:N,className:"ins-m-no-styling",gridBreakPoint:""},m().createElement(f.TableHeader,null),m().createElement(f.TableBody,null)))))}))};N.propTypes={fetchVulnerabilities:y().func,vulnerabilities:y().object,vulnerabilitiesFetchStatus:y().string,selectedTags:y().array,workloads:w.ib,SID:y().arrayOf(y().string)};const O=(0,_.connect)((function(e){var t=e.DashboardStore;return{vulnerabilities:t.vulnerabilities,vulnerabilitiesFetchStatus:t.vulnerabilitiesFetchStatus,selectedTags:t.selectedTags,workloads:t.workloads,SID:t.SID}}),(function(e){return{fetchVulnerabilities:function(t){return e(r.Q6(t))}}}))(N)}}]);
//# sourceMappingURL=3848.90715945acf85ccc5069.js.map