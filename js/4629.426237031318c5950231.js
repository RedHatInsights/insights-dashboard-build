(self.webpackChunkinsights_dashboard=self.webpackChunkinsights_dashboard||[]).push([[4629],{68774:(e,t,a)=>{"use strict";a.d(t,{D:()=>s});var n=a(65353),r=a(32747),l=a(62873),i=a(38296);const s=e=>{var{children:t,className:a="",isVisited:s=!1}=e,c=(0,n._T)(e,["children","className","isVisited"]);return r.createElement("div",Object.assign({},c,{className:(0,i.i)(l.Z.content,s&&l.Z.modifiers.visited,a)}),t)};s.displayName="TextContent"},52643:(e,t,a)=>{"use strict";a.d(t,{b:()=>s});var n=a(65353),r=a(32747),l=a(38296),i=a(66042);const s=e=>{var{children:t=null,className:a="",component:s="div"}=e,c=(0,n._T)(e,["children","className","component"]);const o=s;return r.createElement(o,Object.assign({className:(0,l.i)(i.Z.bullseye,a)},c),t)};s.displayName="Bullseye"},62873:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n}),a(10108);const n={content:"pf-v5-c-content",modifiers:{visited:"pf-m-visited",plain:"pf-m-plain"}}},66042:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n}),a(87234);const n={bullseye:"pf-v5-l-bullseye"}},33818:(e,t,a)=>{"use strict";a.d(t,{u:()=>m});var n=a(45987),r=a(10310),l=a(95665),i=a(20243),s=a(32747),c=a.n(s),o=a(45697),d=a.n(o),u=["index"],m=function(e){var t=e.ariaDesc,a=e.ariaTitle,s=e.constrainToVisibleArea,o=e.data,d=e.legendData,m=e.padding,p=e.height,f=e.width,v=e.legendOrientation,b=e.colorScale,g=e.legend,h=e.legendWidth,_=e.legendHeight,y=e.legendClick,E=function(e){var t=e.index,l=(0,n.Z)(e,u);return c().createElement("a",{id:"".concat(a.toLowerCase().replace(/\s/g,"-"),"-legend-").concat(t+1),href:y[t],className:"pf-v5-c-button pf-m-link pf-m-inline"},c().createElement(r.D,l))};return c().createElement("div",{className:"insd-c-pie-chart__row"},c().createElement("div",{style:{width:f,height:p,position:"relative"}},c().createElement(i.T,{ariaDesc:t,ariaTitle:a,constrainToVisibleArea:s,data:o,height:p,labels:function(e){var t=e.datum;return"".concat(t.x,": ").concat(t.y)},padding:m,width:f,colorScale:b}),c().createElement("table",{tabIndex:"0",className:"visually-hidden","aria-label":a+" data"},c().createElement("tbody",null,o.map((function(e,t){return[c().createElement("tr",{key:t},c().createElement("td",null,e.y),c().createElement("td",null,e.x))]}))))),g&&c().createElement("div",{className:"insd-c-pie-chart__legend","aria-label":"Chart legend",style:{width:h,height:_}},c().createElement(l.Q,{height:_,width:h,fontSize:14,data:d,rowGutter:{top:-5,bottom:-5},orientation:v,labelComponent:y&&c().createElement(E,null)})))};m.propTypes={ariaDesc:d().string,ariaTitle:d().string,constrainToVisibleArea:d().bool,data:d().array,legendData:d().array,padding:d().object,height:d().number,width:d().number,legendOrientation:d().string,colorScale:d().array,legend:d().bool,legendWidth:d().number,legendHeight:d().number,legendClick:d().any}},74183:(e,t,a)=>{"use strict";a.d(t,{M:()=>u});var n=a(87462),r=a(45987),l=a(32203),i=a(32747),s=a.n(i),c=a(45697),o=a.n(c),d=["className","children"],u=function(e){var t=e.className,a=e.children,i=(0,r.Z)(e,d);return s().createElement(l.Z,(0,n.Z)({className:"insd-c-dashboard-compound-card insd-c-dashboard__card ".concat(t)},i),a)};u.propTypes={children:o().any,className:o().string}},23897:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var n=a(4942),r=a(70885),l=a(57149),i=a(75824),s=a(68774),c=a(47173),o=a(28191),d=a(32747),u=a.n(d),m=a(64672),p=a(66794),f=a(65422),v=a(74183),b=a(10358),g=a(37486),h=a(91727),_=a(46891),y=a(33818),E=a(96191),S=a(30893),x=a(86896),N=a(15432),w=a.n(N),C=a(91607),Z=a(71094),T=a(59303),O=a(35981),k=a(49004),M=a(58027);function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const j=function(){var e=(0,x.Z)(),t=[],a=[],n=[],N=(0,f.I0)(),D=(0,f.v9)((function(e){return e.DashboardStore.vulnerabilities})),j=(0,f.v9)((function(e){return e.DashboardStore.vulnerabilitiesFetchStatus})),A=(0,f.v9)((function(e){return e.DashboardStore.selectedTags})),P=(0,f.v9)((function(e){return e.DashboardStore.workloads})),I=(0,f.v9)((function(e){return e.DashboardStore.SID})),z=function(e){return u().createElement("strong",null,e)},B=(0,d.useState)(!1),F=(0,r.Z)(B,2),K=F[0],W=F[1],L=(0,C.y)("vulnerability.edge_parity"),Q=function(e){return u().createElement(i.u,{key:e,position:i.D.right,content:u().createElement("div",null,e)},u().createElement("span",{"aria-label":"Action",className:"insd-c-info-icon pf-v5-u-ml-sm"},u().createElement(h.Z,null)))},H=[{title:"CVSS score"},{title:"CVE totals",transforms:[m.textCenter],cellTransforms:[m.textCenter]},{title:u().createElement("span",null,"Known exploits",Q(e.formatMessage(S.Z.exploitedCveTooltip))),transforms:[m.fitContent]}];(0,d.useEffect)((function(){var e,t,a,n;n=V(V(V(V(V({},(null==P||null===(e=P.SAP)||void 0===e?void 0:e.isSelected)&&{sap_system:!0}),(null==P||null===(t=P["Ansible Automation Platform"])||void 0===t?void 0:t.isSelected)&&{ansible:"true"}),(null==P||null===(a=P["Microsoft SQL"])||void 0===a?void 0:a.isSelected)&&{mssql:"true"}),(null==I?void 0:I.length)>0&&{sap_sids:I}),(null==A?void 0:A.length)>0&&{tags:A}),N(l.Q6(n))}),[P,I,A,N]),(0,d.useEffect)((function(){Z.Z.get(T.oP,{},{limit:1}).then((function(){var e,t,a=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).data;return W((null==a||null===(e=a.meta)||void 0===e||null===(t=e.system_count_per_type)||void 0===t?void 0:t.edge)>0||!1)}))}),[]);var J=K&&L?"rpmdnf,edge":"true";if("fulfilled"===j){var R=D.cves_by_severity;t=[{x:"CVSS 8.0 - 10",from:8,to:10,y:R["8to10"].count,fill:"#a30000",data:R["8to10"]},{x:"CVSS 4.0 - 7.9",from:4,to:7.9,y:R["4to7.9"].count,fill:"#ec7a08",data:R["4to7.9"]},{x:"CVSS 0.0 - 3.9",from:0,to:3.9,y:R["0to3.9"].count,fill:"#f0ab00",data:R["0to3.9"]}],n=function(e,t){return"/cves?cvss_from=".concat(e,"&cvss_to=").concat(t)},a=t.map((function(e){var t=e.data,a=e.from,r=e.to,l=e.fill;return[{title:u().createElement(m.TableText,{wrapModifier:"nowrap",className:"insd-c-legend__dot",style:{"--insd-c-legend__dot--BackgroundColor":"".concat(l)}},u().createElement(w(),{to:n(a,r),app:"vulnerability"},"".concat(a,".0 - ").concat(r)))},{title:u().createElement(w(),{app:"vulnerability",to:n(a,r),className:"pf-v5-u-text-align-center"},t.count),props:{textCenter:!0}},{title:u().createElement(w(),{app:"vulnerability",to:n(a,r)+"&known_exploit=true",className:"pf-v5-u-text-align-center"},void 0===t.known_exploits?"N/A":t.known_exploits),props:{textCenter:!0}}]}))}return"rejected"===j?u().createElement(p.wh,{isFilled:!1,className:"ins-c-card__vulnerability","data-ouia-safe":!0},u().createElement(p.ME,{title:e.formatMessage(S.Z.vulnerabilitiesTitle)}),u().createElement(p.jA,null,u().createElement(g.Z,{appName:"Vulnerability"}))):u().createElement(v.M,{className:"insd-c-dashboard-card-parent insd-c-dashboard__card--compound--Vulnerabilities","data-ouia-safe":"pending"!==j},u().createElement(b.t,{appName:"Vulnerabilities",className:"insd-m-toggle-right-on-md insd-m-short-header","data-ouia-safe":"pending"!==j,title:e.formatMessage(S.Z.vulnerabilitiesTitle),isExpanded:JSON.parse(localStorage.getItem("dashboard_expanded_vulnerability1")||"true"),isExpandedCallback:function(e){return localStorage.setItem("dashboard_expanded_vulnerability1",e)},body:"fulfilled"===j?u().createElement(p.jA,{className:"insd-c-dashboard__card--Vulnerabilities__card-body"},u().createElement(o.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"},flexWrap:{default:"nowrap"}},u().createElement(s.D,{className:"insd-c-width-limiter",style:{"--insd-c-width-limiter--MaxWidth":"54ch"}},u().createElement("p",{className:"pf-v5-u-font-size-sm"},e.formatMessage(S.Z.vulnerabilityMessage))),u().createElement("div",{className:"insd-c-dashboard__card--Vulnerabilities--SplitMetrics"},u().createElement("div",{className:"insd-c-dashboard__card--Vulnerabilities--SplitMetrics__item"},u().createElement("div",{className:"insd-c-dashboard__card--Vulnerabilities--SplitMetrics__content"},u().createElement(w(),{className:"pf-v5-u-font-size-2xl pf-v5-u-color-100","aria-label":"Security rules link",app:"vulnerability",to:"/cves?affecting=".concat(J,"&rule_presence=true"),rel:"noreferrer"},D.rules_cves_total),u().createElement(s.D,null,u().createElement("p",{className:"pf-v5-u-font-size-sm"},e.formatMessage(S.Z.cvesImpactingOneOrMoreSystems,{cves:D.rules_cves_total,strong:function(e){return z(e)}})))),u().createElement(w(),{"aria-label":"Security rules link",app:"vulnerability",to:"/cves?affecting=".concat(J,"&rule_presence=true"),rel:"noreferrer"},u().createElement(c.zx,{variant:"secondary",size:"sm"},e.formatMessage(S.Z.vulnerabilityCardCTAText)))),u().createElement("div",{className:"insd-c-dashboard__card--Vulnerabilities--SplitMetrics__item"},u().createElement("div",{className:"insd-c-dashboard__card--Vulnerabilities--SplitMetrics__content"},u().createElement(w(),{"aria-label":"Known exploit link",className:"pf-v5-u-font-size-2xl pf-v5-u-color-100",app:"vulnerability",to:"/cves?known_exploit=true&affecting=".concat(J),rel:"noreferrer"},D.exploited_cves_count),u().createElement(s.D,null,u().createElement("p",{className:"pf-v5-u-font-size-sm"},e.formatMessage(S.Z.knownExploitsOneOrMoreSystems,{cves:D.exploited_cves_count,strong:function(e){return z(e)},tooltip:function(){return Q(e.formatMessage(S.Z.exploitedCveTooltip))}})))),u().createElement(w(),{"aria-label":"Known exploit link",app:"vulnerability",to:"/cves?known_exploit=true&affecting=".concat(J),rel:"noreferrer"},u().createElement(c.zx,{rel:"noreferrer",variant:"secondary",size:"sm"},e.formatMessage(S.Z.vulnerabilityCardKnownExploitsCTAText))))))):u().createElement(_.Z,null)}),u().createElement(b.t,{appName:"CVESbyCVSS",className:"insd-m-toggle-right-on-md","data-ouia-safe":"pending"!==j,title:e.formatMessage(S.Z.cveByCvssScoreTitle),isExpanded:JSON.parse(localStorage.getItem("dashboard_expanded_vulnerability2")||"true"),isExpandedCallback:function(e){return localStorage.setItem("dashboard_expanded_vulnerability2",e)},hasDivider:!0,body:"fulfilled"===j?u().createElement(p.jA,{className:"ins-c-cves-by-cvss-card-body pf-v5-u-pt-sm"},u().createElement("div",{className:"insd-c-dashboard__card-chart-container"},u().createElement("div",{className:"insd-c-dashboard__card-pie-chart"},u().createElement(y.u,{ariaDesc:e.formatMessage(S.Z.cvesImpactingSystems,{cves:D.cves_total}),ariaTitle:"Vulnerabilities chart",constrainToVisibleArea:!0,data:t,padding:{bottom:0,left:0,right:0,top:0},colorScale:"fulfilled"===j&&0===D.cves_total?[E.Z.value]:["#a30000","#ec7a08","#f0ab00"]})),u().createElement("div",{className:"insd-c-dashboard__card-pie-chart-legend"},u().createElement(O.i,{borders:!1,"aria-label":"Simple Table",cells:H,rows:a,className:"insd-m-no-styling",gridBreakPoint:""},u().createElement(k.x,null),u().createElement(M.R,null))))):u().createElement(_.Z,null)}))}},91607:(e,t,a)=>{"use strict";a.d(t,{y:()=>r});var n=a(64227),r=function(e){var t=(0,n.useFlagsStatus)().flagsReady,a=(0,n.useFlag)(e);return!!t&&a}},45467:()=>{},10108:()=>{},21626:()=>{},8572:()=>{},98379:()=>{},91993:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},49854:()=>{},87234:()=>{}}]);
//# sourceMappingURL=../sourcemaps/4629.aff7ae302c8e8e4b7a0229f32d1c9aa6.js.map