{"version":3,"sources":["webpack://insights-dashboard/./src/SmartComponents/Vulnerability/VulnerabilityCard.js"],"names":["intl","useIntl","columns","title","transforms","fitContent","chartData","rows","legendLink","dispatch","useDispatch","vulnerabilities","useSelector","DashboardStore","vulnerabilitiesFetchStatus","selectedTags","workloads","SID","useEffect","options","SAP","isSelected","sap_system","length","sap_sids","tags","AppActions","bySeverity","cves_by_severity","x","from","to","y","count","fill","map","data","UI_BASE","TableText","wrapModifier","className","style","href","props","textCenter","isFilled","data-ouia-safe","formatMessage","messages","appName","component","body","direction","default","spaceItems","alignItems","justifyContent","rel","total","rules_total","rules_cves_total","cves","variant","isSmall","hasDivider","ariaDesc","cves_total","ariaTitle","constrainToVisibleArea","padding","bottom","left","right","top","height","width","colorScale","flex","Table","borders","aria-label","cells","gridBreakPoint","TableHeader","TableBody"],"mappings":"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","file":"js/3848.ab919adc586bc78ed12c.js","sourcesContent":["import * as AppActions from '../../AppActions';\n\nimport { Button, Card, TextContent } from '@patternfly/react-core/dist/esm/components';\nimport { Flex, FlexItem } from '@patternfly/react-core/dist/esm/layouts';\nimport React, { useEffect } from 'react';\nimport { Table, TableBody, TableHeader, TableText, fitContent } from '@patternfly/react-table';\nimport { TemplateCard, TemplateCardBody, TemplateCardHeader } from '../../PresentationalComponents/Template/TemplateCard';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { ExpandableCardTemplate } from '../../PresentationalComponents/Template/ExpandableCardTemplate';\nimport FailState from '../../PresentationalComponents/FailState/FailState';\nimport Loading from '../../PresentationalComponents/Loading/Loading';\nimport { PieChart } from '../../ChartTemplates/PieChart/PieChartTemplate';\nimport { UI_BASE } from '../../AppConstants';\nimport messages from '../../Messages';\nimport { useIntl } from 'react-intl';\n\nconst VulnerabilityCard = () => {\n    const intl = useIntl();\n    const columns = [{ title: 'CVSS score', transforms: [fitContent] }, { title: 'CVE totals', transforms: [fitContent] }];\n    const pieChartPadding = { bottom: 0, left: 0, right: 0, top: 0 };\n    let chartData = [];\n    let rows = [];\n    let legendLink = [];\n\n    const dispatch = useDispatch();\n    const vulnerabilities = useSelector(({ DashboardStore }) => DashboardStore.vulnerabilities);\n    const vulnerabilitiesFetchStatus = useSelector(({ DashboardStore }) => DashboardStore.vulnerabilitiesFetchStatus);\n    const selectedTags = useSelector(({ DashboardStore }) => DashboardStore.selectedTags);\n    const workloads = useSelector(({ DashboardStore }) => DashboardStore.workloads);\n    const SID = useSelector(({ DashboardStore }) => DashboardStore.SID);\n\n    useEffect(() => {\n        const options = {\n            ...workloads?.SAP?.isSelected && { sap_system: true },\n            ...SID?.length > 0 && { sap_sids: SID },\n            ...selectedTags?.length > 0 && { tags: selectedTags }\n        };\n        const fetchVulnerabilities = options => dispatch(AppActions.fetchVulnerabilities(options));\n\n        fetchVulnerabilities(options);\n    }, [workloads, SID, selectedTags, dispatch]);\n\n    if (vulnerabilitiesFetchStatus === 'fulfilled') {\n        let { cves_by_severity: bySeverity } = vulnerabilities;\n\n        chartData = [\n            {\n                x: 'CVSS 8.0 - 10',\n                from: 8.0,\n                to: 10.0,\n                y: bySeverity['8to10'].count,\n                fill: '#a30000'\n            },\n            {\n                x: 'CVSS 4.0 - 7.9',\n                from: 4.0,\n                to: 7.9,\n                y: bySeverity['4to7.9'].count,\n                fill: '#ec7a08'\n            },\n            {\n                x: 'CVSS 0.0 - 3.9',\n                from: 0.0,\n                to: 3.9,\n                y: bySeverity['0to3.9'].count,\n                fill: '#f0ab00'\n            }\n        ];\n\n        legendLink = chartData.map((data) => `${UI_BASE}/vulnerability/cves?cvss_from=${data.from}&cvss_to=${data.to}`);\n\n        rows = [[{\n            title: <TableText wrapModifier=\"nowrap\" className=\"ins-c-legend__dot\"\n                style={{ '--ins-c-legend__dot--BackgroundColor': '#a30000' }}>\n                <a href={legendLink[0]}>8.0 - 10</a>\n            </TableText>\n        }, {\n            title: <a href={legendLink[0]} className=\"pf-u-text-align-center\">{bySeverity['8to10'].count}</a>,\n            props: { textCenter: true }\n        }\n        ], [{\n            title: <TableText wrapModifier=\"nowrap\" className=\"ins-c-legend__dot\"\n                style={{ '--ins-c-legend__dot--BackgroundColor': '#ec7a08' }}>\n                <a href={legendLink[1]} className=\"pf-u-text-align-center\">4.0 - 7.9</a>\n            </TableText>\n        }, {\n            title: <a href={legendLink[1]} className=\"pf-u-text-align-center\">{bySeverity['4to7.9'].count}</a>,\n            props: { textCenter: true }\n        }\n        ], [{\n            title: <TableText wrapModifier=\"nowrap\" className=\"ins-c-legend__dot\"\n                style={{ '--ins-c-legend__dot--BackgroundColor': '#f0ab00' }}>\n                <a href={legendLink[2]}>0.0 - 3.9</a>\n            </TableText>\n        }, {\n            title: <a href={legendLink[2]}>{bySeverity['0to3.9'].count}</a>,\n            props: { textCenter: true }\n        }]];\n\n    }\n\n    if (vulnerabilitiesFetchStatus === 'rejected') {\n        return <TemplateCard isFilled={false} className='ins-c-card__vulnerability' data-ouia-safe>\n            <TemplateCardHeader title={intl.formatMessage(messages.vulnerabilitiesTitle)} />\n            <TemplateCardBody><FailState appName='Vulnerability' /></TemplateCardBody>\n        </TemplateCard>;\n    }\n\n    return <Card component='div' className=\"ins-c-dashboard-card-parent\" data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}>\n        <ExpandableCardTemplate\n            appName='Vulnerabilities'\n            className='ins-m-toggle-right-on-md ins-m-short-header'\n            data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}\n            title={intl.formatMessage(messages.vulnerabilitiesTitle)}\n            body={\n                vulnerabilitiesFetchStatus !== 'fulfilled' ? <Loading /> :\n                    <TemplateCardBody className=\"ins-c-custom-policies__card-body\">\n                        <Flex\n                            direction={{ default: 'column' }}\n                            spaceItems={{ default: 'spaceItemsLg' }}>\n                            <TextContent>\n                                <p className=\"pf-u-font-size-sm\">\n                                    {intl.formatMessage(messages.vulnerabilityMessage)}\n                                </p>\n                            </TextContent>\n                            <Flex\n                                direction={{ default: 'column' }}\n                                spaceItems={{ default: 'spaceItemsLg' }}\n                                alignItems={{ default: 'alignItemsCenter' }}\n                                justifyContent={{ default: 'justifyContentCenter' }}>\n                                <Flex\n                                    direction={{ default: 'column' }}\n                                    spaceItems={{ default: 'spaceItemsNone' }}>\n                                    <a className=\"pf-u-font-size-2xl pf-u-text-align-center pf-u-color-100\"\n                                        href={`${UI_BASE}/vulnerability/`} rel='noreferrer'>\n                                        {intl.formatMessage(messages.vulnerabilitiesTotalItems, { total: vulnerabilities.rules_total\n                                            || vulnerabilities.rules_cves_total })}\n                                    </a>\n                                    <TextContent\n                                        className='ins-c-width-limiter pf-u-text-align-center'\n                                        style={{ '--ins-c-width-limiter--MaxWidth': '24ch' }}>\n                                        <p className=\"pf-u-font-size-sm\">\n                                            {intl.formatMessage(messages.cvesImpactingOneOrMoreSystems, { cves: vulnerabilities.rules_total\n                                                || vulnerabilities.rules_cves_total })}\n                                        </p>\n                                    </TextContent>\n                                </Flex>\n                                <Button component=\"a\" href={`${UI_BASE}/vulnerability/`} rel='noreferrer'\n                                    variant=\"secondary\" isSmall>\n                                    {intl.formatMessage(messages.vulnerabilityCardCTAText)}\n                                </Button>\n                            </Flex>\n                        </Flex>\n                    </TemplateCardBody>\n            }/>\n        <ExpandableCardTemplate\n            appName='CVESbyCVSS'\n            className='ins-m-toggle-right-on-md'\n            data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}\n            title={intl.formatMessage(messages.cveByCvssScoreTitle)}\n            hasDivider\n            body={vulnerabilitiesFetchStatus !== 'fulfilled' ? <Loading /> :\n                <TemplateCardBody className=\"ins-c-custom-policies__card-body pf-u-pt-sm\">\n                    <Flex alignItems={{ default: 'alignItemsCenter' }}>\n                        <FlexItem>\n                            <PieChart\n                                ariaDesc={intl.formatMessage(messages.cvesImpactingSystems,\n                                    { cves: vulnerabilities.cves_total })}\n                                ariaTitle=\"Vulnerabilities chart\"\n                                constrainToVisibleArea={true}\n                                data={chartData}\n                                padding={pieChartPadding}\n                                height={100}\n                                width={100}\n                                colorScale={['#a30000', '#ec7a08', '#f0ab00']}/>\n                        </FlexItem>\n                        <FlexItem flex={{ default: 'flex_1s' }}>\n                            <Table\n                                borders={false}\n                                aria-label=\"Simple Table\"\n                                cells={columns}\n                                rows={rows}\n                                className='ins-m-no-styling'\n                                gridBreakPoint=''>\n                                <TableHeader />\n                                <TableBody />\n                            </Table>\n                        </FlexItem>\n                    </Flex>\n                </TemplateCardBody>\n            }/>\n    </Card>;\n};\n\nexport default VulnerabilityCard;\n"],"sourceRoot":""}