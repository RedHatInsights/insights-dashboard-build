(self.webpackChunkinsights_dashboard=self.webpackChunkinsights_dashboard||[]).push([[1776],{25980:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var i=a(94015),r=a.n(i),n=a(23645),l=a.n(n)()(r());l.push([e.id,".dashboard .stackChartLegend{left:-9px;position:relative}.dashboard .ins-c-stack-chart{height:40px;width:525px;margin:10px 0 10px 0}.dashboard .visually-hidden{position:absolute !important;top:-40px;font-size:10px;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px, 1px, 1px, 1px);white-space:nowrap}\n","",{version:3,sources:["webpack://./src/ChartTemplates/StackChart/_StackChartTemplate.scss"],names:[],mappings:"AAAA,6BACkB,SAAS,CAAC,iBAAiB,CAD7C,8BACiE,WAAW,CAAC,WAAW,CAAC,oBAAoB,CAD7G,4BAC+H,4BAA4B,CAAC,SAAS,CAAC,cAAc,CAAC,UAAU,CAAC,SAAS,CAAC,eAAe,CAAC,0BAA0B,CAAC,6BAA6B,CAAC,kBAAkB",sourcesContent:[".dashboard{\n.stackChartLegend{left:-9px;position:relative}.ins-c-stack-chart{height:40px;width:525px;margin:10px 0 10px 0}.visually-hidden{position:absolute !important;top:-40px;font-size:10px;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px, 1px, 1px, 1px);white-space:nowrap}\n\n}"],sourceRoot:""}]);const c=l},19128:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var i=a(94015),r=a.n(i),n=a(23645),l=a.n(n)()(r());l.push([e.id,'.dashboard .pf-c-divider{--pf-c-divider--Height: var(--pf-global--BorderWidth--sm);--pf-c-divider--BackgroundColor: var(--pf-global--BorderColor--100);--pf-c-divider--after--Height: var(--pf-c-divider--Height);--pf-c-divider--after--BackgroundColor: var(--pf-c-divider--BackgroundColor);--pf-c-divider--after--FlexBasis: 100%;--pf-c-divider--after--Inset: 0%;--pf-c-divider--m-vertical--after--FlexBasis: 100%;--pf-c-divider--m-vertical--after--Width: var(--pf-global--BorderWidth--sm);display:flex;align-items:center;align-self:stretch;justify-content:center;width:100%;border:0}.dashboard .pf-c-divider::after{flex-basis:calc(var(--pf-c-divider--after--FlexBasis) - calc(var(--pf-c-divider--after--Inset) * 2));align-self:stretch;height:var(--pf-c-divider--after--Height);content:"";background-color:var(--pf-c-divider--after--BackgroundColor);justify-self:center}.dashboard .pf-c-divider.pf-m-vertical{display:inline-flex;flex-direction:column;margin-left:24px;width:auto;height:inherit;min-height:100%;max-height:100%}.dashboard .pf-c-divider.pf-m-vertical::after{flex-basis:calc(var(--pf-c-divider--m-vertical--after--FlexBasis) - var(--pf-c-divider--after--Inset));width:var(--pf-c-divider--m-vertical--after--Width)}\n',"",{version:3,sources:["webpack://./src/PresentationalComponents/VerticalDivider/VerticalDivider.scss"],names:[],mappings:"AAAA,yBACc,yDAAuB,CAAmC,mEAAgC,CAAoC,0DAA8B,CAA6B,4EAAuC,CAAsC,sCAAiC,CAAM,gCAA6B,CAAI,kDAA6C,CAAM,2EAAyC,CAAmC,YAAY,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,UAAU,CAAC,QAAQ,CADxjB,gCAC8kB,oGAAoG,CAAC,kBAAkB,CAAC,yCAAyC,CAAC,UAAU,CAAC,4DAA4D,CAAC,mBAAmB,CAD30B,uCACw2B,mBAAmB,CAAC,qBAAqB,CAAC,gBAAgB,CAAC,UAAU,CAAC,cAAc,CAAC,eAAe,CAAC,eAAe,CAD59B,8CACggC,sGAAsG,CAAC,mDAAmD",sourcesContent:['.dashboard{\n.pf-c-divider{--pf-c-divider--Height: var(--pf-global--BorderWidth--sm);--pf-c-divider--BackgroundColor: var(--pf-global--BorderColor--100);--pf-c-divider--after--Height: var(--pf-c-divider--Height);--pf-c-divider--after--BackgroundColor: var(--pf-c-divider--BackgroundColor);--pf-c-divider--after--FlexBasis: 100%;--pf-c-divider--after--Inset: 0%;--pf-c-divider--m-vertical--after--FlexBasis: 100%;--pf-c-divider--m-vertical--after--Width: var(--pf-global--BorderWidth--sm);display:flex;align-items:center;align-self:stretch;justify-content:center;width:100%;border:0}.pf-c-divider::after{flex-basis:calc(var(--pf-c-divider--after--FlexBasis) - calc(var(--pf-c-divider--after--Inset) * 2));align-self:stretch;height:var(--pf-c-divider--after--Height);content:"";background-color:var(--pf-c-divider--after--BackgroundColor);justify-self:center}.pf-c-divider.pf-m-vertical{display:inline-flex;flex-direction:column;margin-left:24px;width:auto;height:inherit;min-height:100%;max-height:100%}.pf-c-divider.pf-m-vertical::after{flex-basis:calc(var(--pf-c-divider--m-vertical--after--FlexBasis) - var(--pf-c-divider--after--Inset));width:var(--pf-c-divider--m-vertical--after--Width)}\n\n}'],sourceRoot:""}]);const c=l},81776:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>L});var i=a(59713),r=a.n(i),n=a(64169),l=a(97522),c=a.n(l),s=a(81404),o=a(81976),d={"0.0 - 3.9":"less4","4.0 - 7.9":"from4to8","8.0 - 10":"from8to10"},f=a(84556),u=a(58093),p=a(82141),A=a(42437),v=a(45697),m=a.n(v),h=a(6479),C=a.n(h),g=a(63038),b=a.n(g),y=(a(49452),a(10310)),x=a(50303),B=a(2370),k=a(23223),E=a(39727),S=a(50403),w=a(80469),D=a(68354),_=a(88144),j=a(58994),O=a(61169),P=a(59641),W=a(2923),Z=function(e){var t=e.ariaTitle,a=e.ariaDesc,i=e.data,r=e.height,n=e.maxWidth,s=e.legendHeight,d=e.legendClick,f=e.legendWidth,u=e.style,p=e.constrainToVisibleArea,A=[P.ZP.value,O.ZP.value,j.ZP.value,_.ZP.value],v=i.map((function(e){return{name:"".concat(e.y," ").concat((0,o.kC)(e.name)),symbol:{type:null}}})),m=i.length&&i.filter((function(e){return e.y>0})).map((function(e){return e.y})),h=m.length&&m.reduce((function(e,t){return e+t}),0),g=(0,l.useState)(),Z=b()(g,2),T=Z[0],F=Z[1],V=(0,l.useRef)(),z=function(){return V.current&&F(V.current.clientWidth)};(0,l.useEffect)((function(){z(),window.addEventListener("resize",z)}),[]);var I=function(e){var a=e.index,i=C()(e,["index"]);return c().createElement("a",{id:"".concat(t.toLowerCase().replace(/\s/g,"-"),"-legend-").concat(a+1),href:d[a],className:"pf-c-button pf-m-link pf-m-inline"},c().createElement(y.Df,i))};return c().createElement(c().Fragment,null,c().createElement("div",{ref:V,"aria-label":"Stack Chart"},c().createElement(x.k,{ariaDesc:a,ariaTitle:t,padding:{bottom:0,left:0,right:0,top:0},width:T,height:r,maxWidth:n},c().createElement(B.C,{axisComponent:c().createElement(c().Fragment,null)}),c().createElement(k.K,{horizontal:!0,colorScale:A},i.map((function(e){return c().createElement(E.B,{key:e,barWidth:25,labelComponent:c().createElement(S.h,{pointerOrientation:"bottom",style:{fontSize:"12px",padding:"10"},orientation:"top",constrainToVisibleArea:p,dx:-T*(e.y/h)/2,dy:-12}),data:[{name:e.name,y:e.y,x:1,label:function(e){var t=e.datum;return"".concat((0,o.kC)(t.name),": ").concat(t.y)}}]})}))))),c().createElement("span",{className:"stackChartLegend","aria-label":"Chart legend"},c().createElement("table",{tabIndex:"0",className:"visually-hidden","aria-label":t+" data"},i.map((function(e,t){return[c().createElement("tr",{key:t},c().createElement("td",null,e.y),c().createElement("td",null,e.name))]}))),c().createElement(w.Qk,{data:v,responsive:!1,height:s,width:f,fontSize:12,className:"pf-m-redhat-font",labelComponent:c().createElement(I,null),orientation:"horizontal",gutter:20,style:{labels:{fill:D.ZP.value}},events:[{target:"labels",eventHandlers:{onMouseOver:function(){return[{mutation:function(){return{style:Object.assign({},u,{fill:W.ZP.value,textDecoration:"underline"})}}}]},onMouseOut:function(){return[{mutation:function(){return null}}]},onClick:function(){return[{mutation:function(){return{style:Object.assign({},u,{fill:W.ZP.value,textDecoration:"underline"})}}}]}}}],colorScale:A})))};Z.propTypes={maxWidth:m().number,ariaDesc:m().string,ariaTitle:m().string,data:m().array,height:m().number,legendHeight:m().number,legendWidth:m().number,legendClick:m().any,style:m().any,constrainToVisibleArea:m().bool};const T=Z;var F=a(20999),V=(a(89594),function(){return c().createElement(f.iz,{className:"pf-m-vertical"})}),z=a(86588),I=a(18623),M=a(86896);function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){r()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var U=function(e){var t=e.fetchVulnerabilities,a=e.vulnerabilities,i=e.vulnerabilitiesFetchStatus,r=e.workloads,n=e.SID,o=e.selectedTags;(0,l.useEffect)((function(){var e,a=N(N(N({},(null==r||null===(e=r.SAP)||void 0===e?void 0:e.isSelected)&&{sap_system:!0}),(null==n?void 0:n.length)>0&&{sap_sids:n}),(null==o?void 0:o.length)>0&&{tags:o});t(a)}),[t,r,n,o]);var v=[],m=[],h=(0,M.Z)();if("fulfilled"===i){var C=a.cves_by_severity,g=a.cves_total;m=(v=[{name:"CVSS 8.0 - 10",x:g,y:C["8to10"].count,fill:"#a30000"},{name:"CVSS 4.0 - 7.9",x:g,y:C["4to7.9"].count,fill:"#ec7a08"},{name:"CVSS 0.0 - 3.9",x:g,y:C["0to3.9"].count,fill:"#f0ab00"}]).map((function(e){return{name:"".concat(e.name),class:e.name,symbol:{fill:"".concat(e.fill),type:"circle"}}}))}var b=v.map((function(e){var t=e.name.split("CVSS ")[1];return"".concat(F.Pu,"/vulnerability/cves?cvss_filter=").concat(d[t])}));return"rejected"===i?c().createElement(s.wh,{isFilled:!1,className:"ins-c-card__vulnerability","data-ouia-safe":!0},c().createElement(s.ME,{title:h.formatMessage(I.Z.vulnerabilitiesTitle)}),c().createElement(s.jA,null,c().createElement(u.Z,{appName:"Vulnerability"}))):c().createElement(s.wh,{isFilled:!1,className:"ins-c-card__vulnerability","data-ouia-safe":"pending"!==i},c().createElement(s.ME,{title:h.formatMessage(I.Z.vulnerabilitiesTitle)}),c().createElement(c().Fragment,null,c().createElement(s.jA,null,"fulfilled"!==i?c().createElement(p.Z,null):c().createElement(A._,{data:h.formatMessage(I.Z.vulnerabilitiesTotalItems,{total:a.cves_total}),dataSize:"md",linkDescription:h.formatMessage(I.Z.cvesImpactingSystems,{cves:a.cves_total}),layout:"horizontal",link:"".concat(F.Pu,"/vulnerability/")}),"fulfilled"!==i?c().createElement(p.Z,null):c().createElement(T,{ariaDesc:h.formatMessage(I.Z.cvesImpactingSystems,{cves:a.cves_total}),ariaTitle:"Vulnerabilities chart",height:40,maxWidth:500,legendHeight:36,legendWidth:500,data:v,constrainToVisibleArea:!1,legendData:m,legendClick:b})),c().createElement(f.iz,null),"fulfilled"!==i?c().createElement(p.Z,null):c().createElement(s.jA,{isFilled:!1,isHorizontalLayout:"true"},c().createElement(A._,{data:a.recent_cves.last90days,dataSize:"md",linkDescription:h.formatMessage(I.Z.lastxdays,{days:90}),link:"".concat(F.Pu,"/vulnerability/cves?publish_date=last90"),flexDirection:{default:"column"}}),c().createElement(V,null),c().createElement(A._,{data:a.recent_cves.last30days,dataSize:"md",linkDescription:h.formatMessage(I.Z.lastxdays,{days:30}),link:"".concat(F.Pu,"/vulnerability/cves?publish_date=last30"),flexDirection:{default:"column"}}),c().createElement(V,null),c().createElement(A._,{data:h.formatMessage(I.Z.latestVulnerabilitiesTotal,{totalLatest:a.recent_cves.last7days}),dataSize:"md",linkDescription:h.formatMessage(I.Z.lastxdays,{days:7}),link:"".concat(F.Pu,"/vulnerability/cves?publish_date=last7"),flexDirection:{default:"column"}}))))};U.propTypes={fetchVulnerabilities:m().func,vulnerabilities:m().object,vulnerabilitiesFetchStatus:m().string,selectedTags:m().array,workloads:o.ib,SID:m().arrayOf(m().string)};const L=(0,z.connect)((function(e){var t=e.DashboardStore;return{vulnerabilities:t.vulnerabilities,vulnerabilitiesFetchStatus:t.vulnerabilitiesFetchStatus,selectedTags:t.selectedTags,workloads:t.workloads,SID:t.SID}}),(function(e){return{fetchVulnerabilities:function(t){return e(n.Q6(t))}}}))(U)},49452:(e,t,a)=>{"use strict";var i=a(93379),r=a.n(i),n=a(25980),l=r()(n.default,{insert:"head",singleton:!1});if(!n.default.locals||e.hot.invalidate){var c=n.default.locals;e.hot.accept(25980,(t=>{n=a(25980),function(e,t,a){if(!e&&t||e&&!t)return!1;var i;for(i in e)if(e[i]!==t[i])return!1;for(i in t)if(!e[i])return!1;return!0}(c,n.default.locals)?(c=n.default.locals,l(n.default)):e.hot.invalidate()}))}e.hot.dispose((function(){l()})),n.default.locals},89594:(e,t,a)=>{"use strict";var i=a(93379),r=a.n(i),n=a(19128),l=r()(n.default,{insert:"head",singleton:!1});if(!n.default.locals||e.hot.invalidate){var c=n.default.locals;e.hot.accept(19128,(t=>{n=a(19128),function(e,t,a){if(!e&&t||e&&!t)return!1;var i;for(i in e)if(e[i]!==t[i])return!1;for(i in t)if(!e[i])return!1;return!0}(c,n.default.locals)?(c=n.default.locals,l(n.default)):e.hot.invalidate()}))}e.hot.dispose((function(){l()})),n.default.locals}}]);
//# sourceMappingURL=1776.a6c33c925508c20f86ca.js.map