(self.webpackChunkinsights_dashboard=self.webpackChunkinsights_dashboard||[]).push([[3897],{23897:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var r=a(96156),n=(a(59081),a(57149)),i=a(35224),l=a(68774),s=a(47173),c=a(28191),o=a(93264),d=a.n(o),u=a(59845),m=a(66794),f=a(77121),p=a(74183),b=a(10358),_=a(37486),h=a(91727),g=a(46891),v=a(33818),A=a(59303),y=a(96191),C=a(30893),E=a(86896);function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const w=function(){var e=(0,E.Z)(),t=[],a=[],r=[],x=(0,f.useDispatch)(),w=(0,f.useSelector)((function(e){return e.DashboardStore.vulnerabilities})),V=(0,f.useSelector)((function(e){return e.DashboardStore.vulnerabilitiesFetchStatus})),M=(0,f.useSelector)((function(e){return e.DashboardStore.selectedTags})),N=(0,f.useSelector)((function(e){return e.DashboardStore.workloads})),D=(0,f.useSelector)((function(e){return e.DashboardStore.SID})),B=function(e){return d().createElement("strong",null,e)},O=function(e){return d().createElement(i.u,{key:e,position:i.D.right,content:d().createElement("div",null,e)},d().createElement("span",{"aria-label":"Action",className:"ins-c-info-icon pf-u-ml-sm"},d().createElement(h.Z,null)))},k=[{title:"CVSS score"},{title:"CVE totals",transforms:[u.textCenter],cellTransforms:[u.textCenter]},{title:d().createElement("span",null,"Known exploits",O(e.formatMessage(C.Z.exploitedCveTooltip))),transforms:[u.fitContent]}];if((0,o.useEffect)((function(){var e,t;t=S(S(S({},(null==N||null===(e=N.SAP)||void 0===e?void 0:e.isSelected)&&{sap_system:!0}),(null==D?void 0:D.length)>0&&{sap_sids:D}),(null==M?void 0:M.length)>0&&{tags:M}),x(n.Q6(t))}),[N,D,M,x]),"fulfilled"===V){var T=w.cves_by_severity;t=[{x:"CVSS 8.0 - 10",from:8,to:10,y:T["8to10"].count,fill:"#a30000",data:T["8to10"]},{x:"CVSS 4.0 - 7.9",from:4,to:7.9,y:T["4to7.9"].count,fill:"#ec7a08",data:T["4to7.9"]},{x:"CVSS 0.0 - 3.9",from:0,to:3.9,y:T["0to3.9"].count,fill:"#f0ab00",data:T["0to3.9"]}],r=function(e,t){return"".concat(A.Pu,"/vulnerability/cves?cvss_from=").concat(e,"&cvss_to=").concat(t)},a=t.map((function(e){var t=e.data,a=e.from,n=e.to,i=e.fill;return[{title:d().createElement(u.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"".concat(i)}},d().createElement("a",{href:r(a,n)},"".concat(a,".0 - ").concat(n)))},{title:d().createElement("a",{href:r(a,n),className:"pf-u-text-align-center"},t.count),props:{textCenter:!0}},{title:d().createElement("a",{href:r(a,n)+"&known_exploit=true",className:"pf-u-text-align-center"},void 0===t.known_exploits?"N/A":t.known_exploits),props:{textCenter:!0}}]}))}return"rejected"===V?d().createElement(m.wh,{isFilled:!1,className:"ins-c-card__vulnerability","data-ouia-safe":!0},d().createElement(m.ME,{title:e.formatMessage(C.Z.vulnerabilitiesTitle)}),d().createElement(m.jA,null,d().createElement(_.Z,{appName:"Vulnerability"}))):d().createElement(p.M,{className:"ins-c-dashboard-card-parent ins-c-dashboard__card--compound--Vulnerabilities","data-ouia-safe":"pending"!==V},d().createElement(b.t,{appName:"Vulnerabilities",className:"ins-m-toggle-right-on-md ins-m-short-header","data-ouia-safe":"pending"!==V,title:e.formatMessage(C.Z.vulnerabilitiesTitle),isExpanded:JSON.parse(localStorage.getItem("dashboard_expanded_vulnerability1")||"true"),isExpandedCallback:function(e){return localStorage.setItem("dashboard_expanded_vulnerability1",e)},body:"fulfilled"===V?d().createElement(m.jA,{className:"ins-c-dashboard__card--Vulnerabilities__card-body"},d().createElement(c.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"},flexWrap:{default:"nowrap"}},d().createElement(l.D,{className:"ins-c-width-limiter",style:{"--ins-c-width-limiter--MaxWidth":"54ch"}},d().createElement("p",{className:"pf-u-font-size-sm"},e.formatMessage(C.Z.vulnerabilityMessage))),d().createElement("div",{className:"ins-c-dashboard__card--Vulnerabilities--SplitMetrics"},d().createElement("div",{className:"ins-c-dashboard__card--Vulnerabilities--SplitMetrics__item"},d().createElement("div",{className:"ins-c-dashboard__card--Vulnerabilities--SplitMetrics__content"},d().createElement("a",{className:"pf-u-font-size-2xl pf-u-color-100",href:"".concat(A.Pu,"/vulnerability/cves?affecting=true,false&rule_presence=true"),rel:"noreferrer"},w.rules_cves_total),d().createElement(l.D,null,d().createElement("p",{className:"pf-u-font-size-sm"},e.formatMessage(C.Z.cvesImpactingOneOrMoreSystems,{cves:w.rules_cves_total,strong:function(e){return B(e)}})))),d().createElement(s.zx,{component:"a",href:"".concat(A.Pu,"/vulnerability/cves?affecting=true,false&rule_presence=true"),rel:"noreferrer",variant:"secondary",isSmall:!0},e.formatMessage(C.Z.vulnerabilityCardCTAText))),d().createElement("div",{className:"ins-c-dashboard__card--Vulnerabilities--SplitMetrics__item"},d().createElement("div",{className:"ins-c-dashboard__card--Vulnerabilities--SplitMetrics__content"},d().createElement("a",{className:"pf-u-font-size-2xl pf-u-color-100",href:"".concat(A.Pu,"/vulnerability/cves?known_exploit=true&affecting=true,false"),rel:"noreferrer"},w.exploited_cves_count),d().createElement(l.D,null,d().createElement("p",{className:"pf-u-font-size-sm"},e.formatMessage(C.Z.knownExploitsOneOrMoreSystems,{cves:w.exploited_cves_count,strong:function(e){return B(e)},tooltip:function(){return O(e.formatMessage(C.Z.exploitedCveTooltip))}})))),d().createElement(s.zx,{component:"a",href:"".concat(A.Pu,"/vulnerability/cves?known_exploit=true&affecting=true,false"),rel:"noreferrer",variant:"secondary",isSmall:!0},e.formatMessage(C.Z.vulnerabilityCardKnownExploitsCTAText)))))):d().createElement(g.Z,null)}),d().createElement(b.t,{appName:"CVESbyCVSS",className:"ins-m-toggle-right-on-md","data-ouia-safe":"pending"!==V,title:e.formatMessage(C.Z.cveByCvssScoreTitle),isExpanded:JSON.parse(localStorage.getItem("dashboard_expanded_vulnerability2")||"true"),isExpandedCallback:function(e){return localStorage.setItem("dashboard_expanded_vulnerability2",e)},hasDivider:!0,body:"fulfilled"===V?d().createElement(m.jA,{className:"ins-c-cves-by-cvss-card-body pf-u-pt-sm"},d().createElement("div",{className:"ins-c-dashboard__card-chart-container"},d().createElement("div",{className:"ins-c-dashboard__card-pie-chart"},d().createElement(v.u,{ariaDesc:e.formatMessage(C.Z.cvesImpactingSystems,{cves:w.cves_total}),ariaTitle:"Vulnerabilities chart",constrainToVisibleArea:!0,data:t,padding:{bottom:0,left:0,right:0,top:0},colorScale:"fulfilled"===V&&0===w.cves_total?[y.Z.value]:["#a30000","#ec7a08","#f0ab00"]})),d().createElement("div",{className:"ins-c-dashboard__card-pie-chart-legend"},d().createElement(u.Table,{borders:!1,"aria-label":"Simple Table",cells:k,rows:a,className:"ins-m-no-styling",gridBreakPoint:""},d().createElement(u.TableHeader,null),d().createElement(u.TableBody,null))))):d().createElement(g.Z,null)}))}},17494:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var r=a(94015),n=a.n(r),i=a(23645),l=a.n(i)()(n());l.push([e.id,".dashboard .ins-c-dashboard__card--Vulnerabilities__card-body{--pf-c-card--child--PaddingBottom: var(--pf-global--spacer--2xl)}@media screen and (min-width: 768px){.dashboard .ins-c-dashboard__card--compound--Vulnerabilities>*:nth-child(2).pf-m-expanded{min-height:16.5625rem}}.dashboard .ins-c-cves-by-cvss-card-body{display:flex;flex-direction:column;justify-content:center}.dashboard .ins-c-dashboard__card--Vulnerabilities--SplitMetrics{display:grid;grid-gap:var(--pf-global--spacer--md);grid-template-columns:repeat(auto-fit, minmax(20ch, 1fr))}.dashboard .ins-c-dashboard__card--Vulnerabilities--SplitMetrics__item{display:flex;flex-direction:column;align-items:center;text-align:center;width:100%}.dashboard .ins-c-dashboard__card--Vulnerabilities--SplitMetrics__content{margin-bottom:var(--pf-global--spacer--md)}.dashboard .ins-c-dashboard__card--Vulnerabilities--SplitMetrics__content .pf-c-content{max-width:20ch}\n","",{version:3,sources:["webpack://./src/SmartComponents/Vulnerability/VulnerabilityCard.scss"],names:[],mappings:"AAAA,8DACmD,gEAAkC,CAA+B,qCADpH,0FACwO,qBAAqB,CAAE,CAD/P,yCAC6R,YAAY,CAAC,qBAAqB,CAAC,sBAAsB,CADtV,iEAC6Y,YAAY,CAAC,qCAAqC,CAAC,yDAAyD,CADzf,uEACsjB,YAAY,CAAC,qBAAqB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,UAAU,CADxoB,0EACwsB,0CAA0C,CADlvB,wFACg0B,cAAc",sourcesContent:[".dashboard{\n.ins-c-dashboard__card--Vulnerabilities__card-body{--pf-c-card--child--PaddingBottom: var(--pf-global--spacer--2xl)}@media screen and (min-width: 768px){.ins-c-dashboard__card--compound--Vulnerabilities>*:nth-child(2).pf-m-expanded{min-height:16.5625rem}}.ins-c-cves-by-cvss-card-body{display:flex;flex-direction:column;justify-content:center}.ins-c-dashboard__card--Vulnerabilities--SplitMetrics{display:grid;grid-gap:var(--pf-global--spacer--md);grid-template-columns:repeat(auto-fit, minmax(20ch, 1fr))}.ins-c-dashboard__card--Vulnerabilities--SplitMetrics__item{display:flex;flex-direction:column;align-items:center;text-align:center;width:100%}.ins-c-dashboard__card--Vulnerabilities--SplitMetrics__content{margin-bottom:var(--pf-global--spacer--md)}.ins-c-dashboard__card--Vulnerabilities--SplitMetrics__content .pf-c-content{max-width:20ch}\n\n}"],sourceRoot:""}]);const s=l},59081:(e,t,a)=>{"use strict";var r=a(93379),n=a.n(r),i=a(17494),l=n()(i.default,{insert:"head",singleton:!1});if(!i.default.locals||e.hot.invalidate){var s=i.default.locals;e.hot.accept(17494,(t=>{i=a(17494),function(e,t,a){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(s,i.default.locals)?(s=i.default.locals,l(i.default)):e.hot.invalidate()}))}e.hot.dispose((function(){l()})),i.default.locals}}]);
//# sourceMappingURL=../sourcemaps/3897.b310fc3effce97a14e6c.js.map