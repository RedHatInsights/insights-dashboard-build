{"version":3,"sources":["webpack://insights-dashboard/./src/SmartComponents/Vulnerability/VulnerabilityCard.js"],"names":["VulnerabilityCard","fetchVulnerabilities","vulnerabilities","vulnerabilitiesFetchStatus","workloads","SID","selectedTags","intl","useIntl","useEffect","options","SAP","isSelected","sap_system","length","sap_sids","tags","columns","title","transforms","fitContent","chartData","rows","legendLink","bySeverity","cves_by_severity","cvesTotal","cves_total","name","from","to","x","y","count","fill","map","data","UI_BASE","TableText","wrapModifier","className","style","href","props","textCenter","isFilled","data-ouia-safe","formatMessage","messages","appName","component","body","direction","default","spaceItems","alignItems","justifyContent","rel","total","cves","variant","isSmall","hasDivider","ariaDesc","ariaTitle","constrainToVisibleArea","labels","datum","padding","bottom","left","right","top","height","width","colorScale","flex","Table","borders","aria-label","cells","gridBreakPoint","TableHeader","TableBody","propTypes","PropTypes","workloadsPropType","connect","DashboardStore","dispatch","AppActions"],"mappings":"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","file":"js/3848.90715945acf85ccc5069.js","sourcesContent":["import * as AppActions from '../../AppActions';\n\nimport { Button, Card, TextContent } from '@patternfly/react-core/dist/esm/components';\nimport { Flex, FlexItem } from '@patternfly/react-core/dist/esm/layouts';\nimport React, { useEffect } from 'react';\nimport { Table, TableBody, TableHeader, TableText, fitContent } from '@patternfly/react-table';\nimport { TemplateCard, TemplateCardBody, TemplateCardHeader } from '../../PresentationalComponents/Template/TemplateCard';\n\nimport { ExpandableCardTemplate } from '../../PresentationalComponents/Template/ExpandableCardTemplate';\nimport FailState from '../../PresentationalComponents/FailState/FailState';\nimport Loading from '../../PresentationalComponents/Loading/Loading';\nimport { PieChart } from '../../ChartTemplates/PieChart/PieChartTemplate';\nimport PropTypes from 'prop-types';\nimport { UI_BASE } from '../../AppConstants';\nimport { connect } from 'react-redux';\nimport messages from '../../Messages';\nimport { useIntl } from 'react-intl';\nimport { workloadsPropType } from '../../Utilities/Common';\n\n/**\n * Vulnerability Card for showing number of critical vulnerabilities\n */\n\nconst VulnerabilityCard = ({ fetchVulnerabilities, vulnerabilities, vulnerabilitiesFetchStatus, workloads, SID, selectedTags }) => {\n    const intl = useIntl();\n\n    useEffect(() => {\n        const options = {\n            ...workloads?.SAP?.isSelected && { sap_system: true },\n            ...SID?.length > 0 && { sap_sids: SID },\n            ...selectedTags?.length > 0 && { tags: selectedTags }\n        };\n\n        fetchVulnerabilities(options);\n    }, [fetchVulnerabilities, workloads, SID, selectedTags]);\n\n    const columns = [{ title: 'CVSS score', transforms: [fitContent] }, { title: 'CVE totals', transforms: [fitContent] }];\n    const pieChartPadding = { bottom: 0, left: 0, right: 0, top: 0 };\n    let chartData = [];\n    let rows = [];\n    let legendLink = [];\n\n    if (vulnerabilitiesFetchStatus === 'fulfilled') {\n        let { cves_by_severity: bySeverity, cves_total: cvesTotal } = vulnerabilities;\n\n        chartData = [\n            {\n                name: 'CVSS 8.0 - 10',\n                from: 8.0,\n                to: 10.0,\n                x: cvesTotal,\n                y: bySeverity['8to10'].count,\n                fill: '#a30000'\n            },\n            {\n                name: 'CVSS 4.0 - 7.9',\n                from: 4.0,\n                to: 7.9,\n                x: cvesTotal,\n                y: bySeverity['4to7.9'].count,\n                fill: '#ec7a08'\n            },\n            {\n                name: 'CVSS 0.0 - 3.9',\n                from: 0.0,\n                to: 3.9,\n                x: cvesTotal,\n                y: bySeverity['0to3.9'].count,\n                fill: '#f0ab00'\n            }\n        ];\n\n        legendLink = chartData.map((data) => `${UI_BASE}/vulnerability/cves?cvss_from=${data.from}&cvss_to=${data.to}`);\n\n        rows = [[{\n            title: <TableText wrapModifier=\"nowrap\" className=\"ins-c-legend__dot\"\n                style={{ '--ins-c-legend__dot--BackgroundColor': '#a30000' }}>\n                <a href={legendLink[0]}>8.0 - 10</a>\n            </TableText>\n        }, {\n            title: <a href={legendLink[0]} className=\"pf-u-text-align-center\">{bySeverity['8to10'].count}</a>,\n            props: { textCenter: true }\n        }\n        ], [{\n            title: <TableText wrapModifier=\"nowrap\" className=\"ins-c-legend__dot\"\n                style={{ '--ins-c-legend__dot--BackgroundColor': '#ec7a08' }}>\n                <a href={legendLink[1]} className=\"pf-u-text-align-center\">4.0 - 7.9</a>\n            </TableText>\n        }, {\n            title: <a href={legendLink[1]} className=\"pf-u-text-align-center\">{bySeverity['4to7.9'].count}</a>,\n            props: { textCenter: true }\n        }\n        ], [{\n            title: <TableText wrapModifier=\"nowrap\" className=\"ins-c-legend__dot\"\n                style={{ '--ins-c-legend__dot--BackgroundColor': '#f0ab00' }}>\n                <a href={legendLink[2]}>0.0 - 3.9</a>\n            </TableText>\n        }, {\n            title: <a href={legendLink[2]}>{bySeverity['0to3.9'].count}</a>,\n            props: { textCenter: true }\n        }]];\n\n    }\n\n    if (vulnerabilitiesFetchStatus === 'rejected') {\n        return <TemplateCard isFilled={false} className='ins-c-card__vulnerability' data-ouia-safe>\n            <TemplateCardHeader title={intl.formatMessage(messages.vulnerabilitiesTitle)} />\n            <TemplateCardBody><FailState appName='Vulnerability' /></TemplateCardBody>\n        </TemplateCard>;\n    }\n\n    return <Card component='div' className=\"ins-c-dashboard-card-parent\" data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}>\n        <ExpandableCardTemplate\n            appName='Vulnerabilities'\n            className='ins-m-toggle-right-on-md ins-m-short-header'\n            data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}\n            title={intl.formatMessage(messages.vulnerabilitiesTitle)}\n            body={\n                vulnerabilitiesFetchStatus !== 'fulfilled' ? <Loading /> :\n                    <TemplateCardBody className=\"ins-c-custom-policies__card-body\">\n                        <Flex\n                            direction={{ default: 'column' }}\n                            spaceItems={{ default: 'spaceItemsLg' }}>\n                            <TextContent>\n                                <p className=\"pf-u-font-size-sm\">\n                                    {intl.formatMessage(messages.vulnerabilityMessage)}\n                                </p>\n                            </TextContent>\n                            <Flex\n                                direction={{ default: 'column' }}\n                                spaceItems={{ default: 'spaceItemsLg' }}\n                                alignItems={{ default: 'alignItemsCenter' }}\n                                justifyContent={{ default: 'justifyContentCenter' }}>\n                                <Flex\n                                    direction={{ default: 'column' }}\n                                    spaceItems={{ default: 'spaceItemsNone' }}>\n                                    <a className=\"pf-u-font-size-2xl pf-u-text-align-center pf-u-color-100\"\n                                        href={`${UI_BASE}/vulnerability/`} rel='noreferrer'>\n                                        {intl.formatMessage(messages.vulnerabilitiesTotalItems, { total: vulnerabilities.cves_total })}\n                                    </a>\n                                    <TextContent\n                                        className='ins-c-width-limiter pf-u-text-align-center'\n                                        style={{ '--ins-c-width-limiter--MaxWidth': '24ch' }}>\n                                        <p className=\"pf-u-font-size-sm\">\n                                            {intl.formatMessage(messages.cvesImpactingOneOrMoreSystems, { cves: vulnerabilities.cves_total })}\n                                        </p>\n                                    </TextContent>\n                                </Flex>\n                                <Button component=\"a\" href={`${UI_BASE}/vulnerability/`} rel='noreferrer'\n                                    variant=\"secondary\" isSmall>\n                                    {intl.formatMessage(messages.vulnerabilityCardCTAText)}\n                                </Button>\n                            </Flex>\n                        </Flex>\n                    </TemplateCardBody>\n            }\n        />\n        <ExpandableCardTemplate\n            appName='CVESbyCVSS'\n            className='ins-m-toggle-right-on-md'\n            data-ouia-safe={vulnerabilitiesFetchStatus !== 'pending'}\n            title={intl.formatMessage(messages.cveByCvssScoreTitle)}\n            hasDivider\n            body={vulnerabilitiesFetchStatus !== 'fulfilled' ? <Loading /> :\n                <TemplateCardBody className=\"ins-c-custom-policies__card-body pf-u-pt-sm\">\n                    <Flex alignItems={{ default: 'alignItemsCenter' }}>\n                        <FlexItem>\n                            <PieChart\n                                ariaDesc={intl.formatMessage(messages.cvesImpactingSystems,\n                                    { cves: vulnerabilities.cves_total })}\n                                ariaTitle=\"Vulnerabilities chart\"\n                                constrainToVisibleArea={true}\n                                data={chartData}\n                                labels={({ datum }) => `${datum.x}: ${datum.y}`}\n                                padding={pieChartPadding}\n                                height={100}\n                                width={100}\n                                colorScale={['#a30000', '#ec7a08', '#f0ab00']}\n                            />\n                        </FlexItem>\n                        <FlexItem flex={{ default: 'flex_1s' }}>\n                            <Table\n                                borders={false}\n                                aria-label=\"Simple Table\"\n                                cells={columns}\n                                rows={rows}\n                                className='ins-m-no-styling'\n                                gridBreakPoint=''\n                            >\n                                <TableHeader />\n                                <TableBody />\n                            </Table>\n                        </FlexItem>\n                    </Flex>\n                </TemplateCardBody>\n            }\n        />\n    </Card>;\n};\n\nVulnerabilityCard.propTypes = {\n    fetchVulnerabilities: PropTypes.func,\n    vulnerabilities: PropTypes.object,\n    vulnerabilitiesFetchStatus: PropTypes.string,\n    selectedTags: PropTypes.array,\n    workloads: workloadsPropType,\n    SID: PropTypes.arrayOf(PropTypes.string)\n};\n\nexport default connect(\n    ({ DashboardStore }) => ({\n        vulnerabilities: DashboardStore.vulnerabilities,\n        vulnerabilitiesFetchStatus: DashboardStore.vulnerabilitiesFetchStatus,\n        selectedTags: DashboardStore.selectedTags,\n        workloads: DashboardStore.workloads,\n        SID: DashboardStore.SID\n    }),\n    dispatch => ({\n        fetchVulnerabilities: (options) => dispatch(AppActions.fetchVulnerabilities(options))\n    })\n)(VulnerabilityCard);\n"],"sourceRoot":""}