(self.webpackChunkinsights_dashboard=self.webpackChunkinsights_dashboard||[]).push([[3848],{633848:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var r=a(896156),l=a(864169),n=a(232203),s=a(768774),c=a(247173),i=a(728191),o=a(992298),u=a(97522),d=a.n(u),m=a(238532),f=a(681404),p=a(843476),b=a(158471),g=a(858093),h=a(382141),E=a(285875),v=a(420999),y=a(518623),_=a(586896);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const C=function(){var e=(0,_.Z)(),t=[{title:"CVSS score",transforms:[m.fitContent]},{title:"CVE totals",transforms:[m.fitContent]}],a=[],r=[],S=[],C=(0,p.useDispatch)(),N=(0,p.useSelector)((function(e){return e.DashboardStore.vulnerabilities})),O=(0,p.useSelector)((function(e){return e.DashboardStore.vulnerabilitiesFetchStatus})),w=(0,p.useSelector)((function(e){return e.DashboardStore.selectedTags})),T=(0,p.useSelector)((function(e){return e.DashboardStore.workloads})),I=(0,p.useSelector)((function(e){return e.DashboardStore.SID}));if((0,u.useEffect)((function(){var e,t;t=x(x(x({},(null==T||null===(e=T.SAP)||void 0===e?void 0:e.isSelected)&&{sap_system:!0}),(null==I?void 0:I.length)>0&&{sap_sids:I}),(null==w?void 0:w.length)>0&&{tags:w}),C(l.Q6(t))}),[T,I,w,C]),"fulfilled"===O){var j=N.cves_by_severity;S=(a=[{x:"CVSS 8.0 - 10",from:8,to:10,y:j["8to10"].count,fill:"#a30000"},{x:"CVSS 4.0 - 7.9",from:4,to:7.9,y:j["4to7.9"].count,fill:"#ec7a08"},{x:"CVSS 0.0 - 3.9",from:0,to:3.9,y:j["0to3.9"].count,fill:"#f0ab00"}]).map((function(e){return"".concat(v.Pu,"/vulnerability/cves?cvss_from=").concat(e.from,"&cvss_to=").concat(e.to)})),r=[[{title:d().createElement(m.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#a30000"}},d().createElement("a",{href:S[0]},"8.0 - 10"))},{title:d().createElement("a",{href:S[0],className:"pf-u-text-align-center"},j["8to10"].count),props:{textCenter:!0}}],[{title:d().createElement(m.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#ec7a08"}},d().createElement("a",{href:S[1],className:"pf-u-text-align-center"},"4.0 - 7.9"))},{title:d().createElement("a",{href:S[1],className:"pf-u-text-align-center"},j["4to7.9"].count),props:{textCenter:!0}}],[{title:d().createElement(m.TableText,{wrapModifier:"nowrap",className:"ins-c-legend__dot",style:{"--ins-c-legend__dot--BackgroundColor":"#f0ab00"}},d().createElement("a",{href:S[2]},"0.0 - 3.9"))},{title:d().createElement("a",{href:S[2]},j["0to3.9"].count),props:{textCenter:!0}}]]}return"rejected"===O?d().createElement(f.wh,{isFilled:!1,className:"ins-c-card__vulnerability","data-ouia-safe":!0},d().createElement(f.ME,{title:e.formatMessage(y.Z.vulnerabilitiesTitle)}),d().createElement(f.jA,null,d().createElement(g.Z,{appName:"Vulnerability"}))):d().createElement(n.Z,{component:"div",className:"ins-c-dashboard-card-parent","data-ouia-safe":"pending"!==O},d().createElement(b.t,{appName:"Vulnerabilities",className:"ins-m-toggle-right-on-md ins-m-short-header","data-ouia-safe":"pending"!==O,title:e.formatMessage(y.Z.vulnerabilitiesTitle),isExpanded:JSON.parse(localStorage.getItem("dashboard_expanded_vulnerability1")||"true"),isExpandedCallback:function(e){return localStorage.setItem("dashboard_expanded_vulnerability1",e)},body:"fulfilled"!==O?d().createElement(h.Z,null):d().createElement(f.jA,{className:"ins-c-custom-policies__card-body"},d().createElement(i.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"}},d().createElement(s.D,null,d().createElement("p",{className:"pf-u-font-size-sm"},e.formatMessage(y.Z.vulnerabilityMessage))),d().createElement(i.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsLg"},alignItems:{default:"alignItemsCenter"},justifyContent:{default:"justifyContentCenter"}},d().createElement(i.k,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},d().createElement("a",{className:"pf-u-font-size-2xl pf-u-text-align-center pf-u-color-100",href:"".concat(v.Pu,"/vulnerability/"),rel:"noreferrer"},e.formatMessage(y.Z.vulnerabilitiesTotalItems,{total:N.rules_total||N.rules_cves_total})),d().createElement(s.D,{className:"ins-c-width-limiter pf-u-text-align-center",style:{"--ins-c-width-limiter--MaxWidth":"24ch"}},d().createElement("p",{className:"pf-u-font-size-sm"},e.formatMessage(y.Z.cvesImpactingOneOrMoreSystems,{cves:N.rules_total||N.rules_cves_total})))),d().createElement(c.zx,{component:"a",href:"".concat(v.Pu,"/vulnerability/cves?affecting=true,false&rule_presence=true"),rel:"noreferrer",variant:"secondary",isSmall:!0},e.formatMessage(y.Z.vulnerabilityCardCTAText)))))}),d().createElement(b.t,{appName:"CVESbyCVSS",className:"ins-m-toggle-right-on-md","data-ouia-safe":"pending"!==O,title:e.formatMessage(y.Z.cveByCvssScoreTitle),isExpanded:JSON.parse(localStorage.getItem("dashboard_expanded_vulnerability2")||"true"),isExpandedCallback:function(e){return localStorage.setItem("dashboard_expanded_vulnerability2",e)},hasDivider:!0,body:"fulfilled"!==O?d().createElement(h.Z,null):d().createElement(f.jA,{className:"ins-c-custom-policies__card-body pf-u-pt-sm"},d().createElement(i.k,{alignItems:{default:"alignItemsCenter"}},d().createElement(o.B,null,d().createElement(E.u,{ariaDesc:e.formatMessage(y.Z.cvesImpactingSystems,{cves:N.cves_total}),ariaTitle:"Vulnerabilities chart",constrainToVisibleArea:!0,data:a,padding:{bottom:0,left:0,right:0,top:0},height:100,width:100,colorScale:["#a30000","#ec7a08","#f0ab00"]})),d().createElement(o.B,{flex:{default:"flex_1s"}},d().createElement(m.Table,{borders:!1,"aria-label":"Simple Table",cells:t,rows:r,className:"ins-m-no-styling",gridBreakPoint:""},d().createElement(m.TableHeader,null),d().createElement(m.TableBody,null)))))}))}}}]);
//# sourceMappingURL=3848.802e03fb064f7f849287.js.map